<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotaract Cyber Awareness Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.lordicon.com/lordicon.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <!-- Chosen Palette: Cool Blues & Neutrals -->
    <!-- CODE REFINEMENT: Refactored threats and scams into dynamic vertical navigation 'Playgrounds' with ARIA support and content transitions. Added new sections and features. -->
    <style>
        @keyframes wiggle {
            0%, 100% { transform: rotate(-3deg); }
            50% { transform: rotate(3deg); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }
        @keyframes slide-in-bubble {
            from { opacity: 0; transform: translateY(10px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        @keyframes typing-indicator-dot {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
            scroll-behavior: smooth;
        }
        .font-mono {
            font-family: 'Roboto Mono', monospace;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .nav-link {
            position: relative;
            transition: color 0.3s;
        }
        .nav-link:hover {
            color: #0ea5e9;
        }
        .nav-link.active {
            color: #0ea5e9;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 100%;
            transform: scaleX(0);
            height: 2px;
            bottom: 0;
            left: 0;
            background-color: #0ea5e9; /* sky-500 */
            transform-origin: bottom center;
            transition: transform 0.25s ease-out;
        }
        .nav-link:hover::after,
        .nav-link.active::after { /* Apply underline to active link too */
            transform: scaleX(1);
            transform-origin: bottom center;
        }
        /* New Playground Navigation Style */
        .threat-nav-item {
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 4px solid transparent;
            border-left: 0;
            font-weight: 500;
            white-space: nowrap;
            flex-shrink: 0;
        }
        @media (min-width: 768px) {
            .threat-nav-item {
                border-left: 4px solid transparent;
                border-bottom: 0;
            }
        }
        .threat-nav-item:hover {
            background-color: #f0f9ff;
            color: #0ea5e9;
        }
        .threat-nav-item.active {
            background-color: #e0f2fe; /* sky-100 */
            color: #0ea5e9; /* sky-500 */
            border-bottom-color: #0ea5e9;
            font-weight: 700;
            transform: scale(1.02);
        }
        @media (min-width: 768px) {
            .threat-nav-item.active {
                border-left-color: #0ea5e9;
                border-bottom-color: transparent;
            }
        }
        /* Dynamic Content Transition */
        .threat-content {
            transition: opacity 0.4s ease-in-out, transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            opacity: 0;
            transform: translateX(20px);
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            visibility: hidden; /* Use visibility instead of display for smoother transitions */
        }
        .threat-content.active {
            opacity: 1;
            transform: translateX(0);
            position: relative;
            visibility: visible;
        }
        /* Card Flip & Demo Styles */
        .card-flip { perspective: 1000px; }
        .card-flip-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .card-flip:hover .card-flip-inner { transform: rotateY(180deg); }
        .card-front, .card-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 1.5rem; border-radius: 0.75rem; }
        .card-back { transform: rotateY(180deg); }
        .email-client { border: 1px solid #e2e8f0; border-radius: 0.5rem; background-color: #ffffff; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06); }
        .email-header { padding: 0.75rem 1rem; border-bottom: 1px solid #e2e8f0; background-color: #f8fafc; }
        .email-body { padding: 1.5rem; }
        .phishing-link { color: #2563eb; text-decoration: underline; cursor: pointer; }
        .phishing-link:hover { color: #1d4ed8; }
        /* Advanced Phishing Spotter */
        .phishing-red-flag { transition: background-color 0.2s; }
        .phishing-red-flag:not(.found):hover {
            animation: wiggle 0.5s ease-in-out;
        }
        .phishing-red-flag.found { background-color: #fecaca !important; /* red-200 */ cursor: default !important; }

        .password-strength-meter { height: 8px; background-color: #e2e8f0; border-radius: 9999px; overflow: hidden; }
        .strength-bar { height: 100%; transition: width 0.5s cubic-bezier(0.25, 1, 0.5, 1), background-color 0.5s; }
        .checklist-item { transition: opacity 0.3s, transform 0.3s; opacity: 0.5; }
        .checklist-item.checked { opacity: 1; }
        .checklist-item.checked::before {
            content: '✓';
            color: #16a34a;
            font-weight: bold;
            margin-right: 0.5rem;
            display: inline-block;
            transform: scale(0);
            animation: pop-in 0.3s forwards;
        }
        @keyframes pop-in {
            to { transform: scale(1); }
        }
        .quiz-option { border: 2px solid #cbd5e1; transition: all 0.2s; }
        .quiz-option:hover { border-color: #38bdf8; background-color: #f0f9ff; }
        .quiz-option.selected { border-color: #0ea5e9; background-color: #e0f2fe; }
        .quiz-option.correct { border-color: #22c55e; background-color: #f0fdf4; pointer-events: none; }
        .quiz-option.incorrect { border-color: #ef4444; background-color: #fef2f2; pointer-events: none; }
        .phone-call-sim { background-color: #1e293b; color: #e2e8f0; border-radius: 1rem; padding: 1.5rem; font-family: 'Roboto Mono', monospace; max-height: 400px; overflow-y: auto; }
        .phone-line { opacity: 0; transition: opacity 0.5s; margin-bottom: 0.75rem; }
        .phone-line.visible { opacity: 1; }
        .red-flag { background-color: #ef4444; color: white; padding: 0.1rem 0.4rem; border-radius: 0.25rem; font-weight: bold; font-size: 0.75rem; }
        /* Dating App Style */
        .dating-app-sim { background-color: #f7f7f7; border-radius: 1.5rem; overflow: hidden; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1); max-width: 350px; margin: 1rem auto 0 auto; }
        .chat-header { background-color: #ff5864; color: white; padding: 0.75rem 1rem; text-align: center; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }
        .chat-bubble-scam, .chat-bubble-user {
            animation: slide-in-bubble 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        }
        .chat-bubble-scam { background-color: #ff5864; color: white; border-radius: 1rem 1rem 1rem 0; padding: 0.75rem 1rem; max-width: 85%; margin-top: 0.5rem; align-self: flex-start; }
        .chat-bubble-user { background-color: #ffffff; color: #1e293b; border: 1px solid #e2e8f0; border-radius: 1rem 1rem 0 1rem; padding: 0.75rem 1rem; max-width: 85%; margin-top: 0.5rem; align-self: flex-end; }
        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            animation: slide-in-bubble 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        }
        .typing-indicator span {
            height: 8px;
            width: 8px;
            background-color: #94a3b8;
            border-radius: 50%;
            margin: 0 2px;
            animation: typing-indicator-dot 1.2s infinite ease-in-out;
        }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        /* Mobile Phone Frame for Demos */
        .mobile-frame {
            width: 360px;
            height: 740px;
            background-color: #111;
            border-radius: 40px;
            padding: 15px;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.5), inset 0 2px 5px 2px rgba(255,255,255,0.1);
            margin: 1rem auto 0 auto;
            position: relative;
        }
        .mobile-screen {
            background-color: #f7f7f7;
            width: 100%;
            height: 100%;
            border-radius: 25px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        .mobile-notch {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 20px;
            background-color: #111;
            border-radius: 0 0 10px 10px;
            z-index: 10;
        }
        /* Wifi Game */
        .wifi-item.dragging { opacity: 0.5; }
        .wifi-dropzone { transition: background-color 0.2s, transform 0.2s; }
        .wifi-dropzone.dragover { background-color: rgba(0,0,0,0.1); transform: scale(1.02); }
        .wifi-dropzone.correct-drop { animation: pulse-green 0.8s; }
        .wifi-dropzone.incorrect-drop { animation: shake 0.5s; }
        /* Password Generator */
        .password-generator output { font-weight: bold; font-family: 'Roboto Mono', monospace; background-color: #e2e8f0; padding: 0.5rem 1rem; border-radius: 0.375rem; word-break: break-all; }
        /* Threat Feed */
        #threat-feed p { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        /* --- Animation Classes for Demos --- */
        .input-error {
            animation: shake 0.5s ease-in-out;
            border-color: #ef4444; /* red-500 */
        }
        .button-success {
            animation: pulse-green 0.8s;
        }
        .button-fail {
            animation: shake 0.5s;
        }
        .chat-bubble-pop-in {
            animation: slide-in-bubble 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        }
        .progress-bar-fill {
            animation: progress-bar-fill 2s linear forwards;
        }
        @keyframes progress-bar-fill {
            from { width: 0%; }
            to { width: 100%; }
        }
        .icon-pop {
            animation: pop-in 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        }
        /* --- Ransomware Demo Styles --- */
        #ransomware-screen.ransomware-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #1a0000;
            color: #ff0000;
            font-family: 'Roboto Mono', monospace;
            z-index: 100;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease-in-out, visibility 0.5s;
            border: 2px solid #ff0000;
            box-shadow: 0 0 20px #ff0000;
        }
        #ransomware-screen.ransomware-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        #ransomware-screen .ransomware-skull {
            font-size: 5rem;
            line-height: 1;
            animation: glitch 1.5s infinite;
        }
        @keyframes glitch {
            2%,64% { transform: translate(2px,0) skew(0deg); }
            4%,60% { transform: translate(-2px,0) skew(0deg); }
            62% { transform: translate(0,0) skew(5deg); }
        }
        #ransomware-screen .ransomware-timer {
            font-size: 2rem;
            margin: 1rem 0;
            color: #ffff00;
            text-shadow: 0 0 5px #ffff00;
        }
        #ransomware-screen .encrypted-files {
            font-size: 0.75rem;
            color: #ff4d4d;
            max-height: 100px;
            overflow: hidden;
            text-align: left;
            width: 80%;
            border: 1px solid #ff3333;
            padding: 0.5rem;
            background: #330000;
        }
        #ransomware-screen .encrypted-files p {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold text-slate-800">
                <span class="text-sky-500">Thotta </span>Thookirvom
            </div>
            <div class="hidden md:flex space-x-8">
                <a href="#about" class="nav-link text-slate-600 font-medium pb-1">About Me</a>
                <a href="#home" class="nav-link text-slate-600 font-medium pb-1">Home</a>
                <a href="#threats" class="nav-link text-slate-600 font-medium pb-1">Common Threats</a>
                <a href="#protection" class="nav-link text-slate-600 font-medium pb-1">Protect Yourself</a>
                <a href="#threat-intel" class="nav-link text-slate-600 font-medium pb-1">Threat Intel</a>
                <a href="#indian-scams" class="nav-link text-slate-600 font-medium pb-1">Indian Scams</a>
                <a href="#quiz" class="nav-link text-slate-600 font-medium pb-1">Quiz</a>
                <a href="#tools" class="nav-link text-slate-600 font-medium pb-1">Free Tools</a>
            </div>
            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-slate-600 focus:outline-none">
                    <svg class="6 h-6"
                </button>
            </div>
        </nav>
        <div id="mobile-menu" class="hidden md:hidden overflow-hidden transition-all duration-300 ease-in-out">
            <a href="#about" class="block py-2 px-6 text-sm text-slate-600 hover:bg-slate-50">About Me</a>
            <a href="#home" class="block py-2 px-6 text-sm text-slate-600 hover:bg-slate-50">Home</a>
            <a href="#threats" class="block py-2 px-6 text-sm text-slate-600 hover:bg-slate-50">Common Threats</a>
            <a href="#protection" class="block py-2 px-6 text-sm text-slate-600 hover:bg-slate-50">Protect Yourself</a>
            <a href="#threat-intel" class="block py-2 px-6 text-sm text-slate-600 hover:bg-slate-50">Threat Intel</a>
            <a href="#indian-scams" class="block py-2 px-6 text-sm text-slate-600 hover:bg-slate-50">Indian Scams</a>
            <a href="#quiz" class="block py-2 px-6 text-sm text-slate-600 hover:bg-slate-50">Quiz</a>
            <a href="#tools" class="block py-2 px-6 text-sm text-slate-600 hover:bg-slate-50">Free Tools</a>
        </div>
    </header>

    <main>
        <section id="about" class="py-16 md:py-24 bg-slate-50">
            <div class="container mx-auto px-6">
                <div class="max-w-4xl mx-auto">
                    <div class="text-center">
                        <img src="my_profile.jpg" alt="Prashanth" class="w-45 h-45 rounded-full mx-auto mb-4 shadow-lg">
                        <h2 class="text-3xl md:text-4xl font-bold text-slate-800">About Me</h2>
                        <p class="mt-2 text-lg text-sky-600 font-semibold">Prashanth E | Application Security Engineer</p>
                    </div>
                    <div class="mt-8 bg-white p-8 rounded-lg shadow-md text-slate-700 space-y-4">
                        <p>I'm Prashanth a.k.a Sunil Prashanth, an <strong class="text-slate-800">Application Security Engineer at Zoho</strong>. My primary focus is on Desktop Application Penetration Testing, ensuring our core products are secure against real world threats.</p>
                        <p>Previously, I was a <strong class="text-slate-800">Software Quality Engineer at Infosys</strong>, where I transitioned into security by integrating automated security tools (SAST/DAST) into the development pipeline and working with teams on secure coding practices.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="home" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-6">
                <div class="grid md:grid-cols-2 gap-12 items-center">
                    <div class="text-center md:text-left">
                        <h1 class="text-4xl md:text-5xl font-bold text-slate-800 leading-tight">Your Digital Life, <span class="text-sky-500">Secured.</span></h1>
                        <p class="mt-4 text-lg text-slate-600">Welcome to Your Digital Defense Session, brought to you by the <span class="font-bold">Rotaract Club of Ambattur</span>. In today's interconnected world, cybersecurity isn't an IT problem it's a fundamental part of personal and professional risk management. Since we are all leaders and professionals from diverse fields, this guide will focus on simple, high impact techniques. We're here to help you build your Human Firewall, giving you actionable steps to protect your valuable information against the most common threats.</p>
                        <a href="#threats" class="mt-8 inline-block bg-sky-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-sky-600 transition-all transform hover:scale-105 hover:shadow-lg">Explore Common Threats</a>
                    </div>
                    <div>
                        <div class="chart-container">
                            <canvas id="attackVectorChart"></canvas>
                        </div>
                        <p class="text-center text-sm text-slate-500 mt-2">Common Initial Attack Vectors in Data Breaches (Illustrative)</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Threat Playground 1: Common Threats (Refactored & Expanded) -->
        <section id="threats" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-800">Cyber Threat Playground</h2>
                    <p class="mt-4 text-lg text-slate-600">Explore classic and emerging threats. Interact with simulations to build your recognition skills and understand the risks.</p>
                </div>

                <div class="mt-12 bg-white rounded-xl shadow-xl overflow-hidden md:flex">
                    <!-- Vertical Navigation -->
                    <nav id="common-threats-nav" class="threat-nav bg-slate-50 md:w-1/4 flex flex-row md:flex-col p-4 space-x-4 md:space-x-0 md:space-y-2 border-b md:border-b-0 md:border-r border-slate-200 overflow-x-auto md:overflow-y-auto max-h-[70vh] md:max-h-none" role="tablist" aria-label="Common & Emerging Cyber Threats">
                        <!-- Navigation items will be injected here by JavaScript -->
                    </nav>
                    
                    <!-- Dynamic Content Area -->
                    <div id="common-threats-content-wrapper" class="md:w-3/4 p-6 relative min-h-[600px] overflow-hidden">
                        <!-- Content panels will be injected here by JavaScript -->
                    </div>
                </div>
            </div>
        </section>

        <section id="protection" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-800">Your Digital Shield: 8 Essential Habits</h2>
                    <p class="mt-4 text-lg text-slate-600">These are the most effective defenses against <strong>99%</strong> of attacks. Adopt these eight habits to build a strong personal defense. Hover over each card for a quick explanation.</p>
                </div>
                <div class="mt-12 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    
                    <div class="card-flip h-64">
                        <div class="card-flip-inner shadow-lg rounded-xl">
                            <div class="card-front bg-sky-500 text-white">
                                <lord-icon
                                    src="https://cdn.lordicon.com/lupuorrc.json"
                                    trigger="loop"
                                    delay="1000"
                                    colors="primary:#ffffff"
                                    style="width:80px;height:80px">
                                </lord-icon>
                                <h3 class="text-2xl font-bold mt-4">Use Strong Passwords</h3>
                            </div>
                            <div class="card-back bg-white text-slate-700 text-center">
                                <h4 class="font-bold">Unique Passphrases</h4>
                                <p class="mt-2 text-sm">Stop reusing passwords! Use a unique, long passphrase (12+ characters) for every account. This prevents one breached site from compromising your whole digital life.</p>
                            </div>
                        </div>
                    </div>

                    <div class="card-flip h-64">
                        <div class="card-flip-inner shadow-lg rounded-xl">
                            <div class="card-front bg-teal-500 text-white">
                                <lord-icon
                                    src="https://cdn.lordicon.com/lthhecik.json"
                                    trigger="loop"
                                    delay="1000"
                                    colors="primary:#ffffff"
                                    style="width:80px;height:80px">
                                </lord-icon>
                                <h3 class="text-2xl font-bold mt-4">Enable 2FA/MFA</h3>
                            </div>
                            <div class="card-back bg-white text-slate-700 text-center">
                                <h4 class="font-bold">Second Layer of Security</h4>
                                <p class="mt-2 text-sm">Two-Factor Authentication is the single most effective defense. It requires a code from your phone (something you *have*) plus your password (something you *know*).</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card-flip h-64">
                        <div class="card-flip-inner shadow-lg rounded-xl">
                            <div class="card-front bg-indigo-500 text-white">
                                <lord-icon
                                    src="https://cdn.lordicon.com/hqrgkqvs.json"
                                    trigger="loop"
                                    delay="1000"
                                    colors="primary:#ffffff"
                                    style="width:80px;height:80px">
                                </lord-icon>
                                <h3 class="text-2xl font-bold mt-4">Keep Software Updated</h3>
                            </div>
                            <div class="card-back bg-white text-slate-700 text-center">
                                <h4 class="font-bold">Patch Vulnerabilities</h4>
                                <p class="mt-2 text-sm">Updates fix security holes that hackers exploit. Always update your operating system, web browser, and apps promptly—it's free security maintenance.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card-flip h-64">
                        <div class="card-flip-inner shadow-lg rounded-xl">
                            <div class="card-front bg-rose-500 text-white">
                                <lord-icon
                                    src="https://cdn.lordicon.com/dqrpfjei.json"
                                    trigger="loop"
                                    delay="1000"
                                    colors="primary:#ffffff"
                                    style="width:80px;height:80px">
                                </lord-icon>
                                <h3 class="text-2xl font-bold mt-4">Think Before You Click</h3>
                            </div>
                            <div class="card-back bg-white text-slate-700 text-center">
                                <h4 class="font-bold">Verify Urgency</h4>
                                <p class="mt-2 text-sm">Be skeptical of unsolicited emails that create urgency or emotional panic. When in doubt, call the sender using a publicly verified phone number, or navigate to the website manually.</p>
                            </div>
                        </div>
                    </div>

                    <div class="card-flip h-64">
                        <div class="card-flip-inner shadow-lg rounded-xl">
                            <div class="card-front bg-amber-500 text-white">
                                <lord-icon
                                    src="https://cdn.lordicon.com/ssvybplt.json"
                                    trigger="loop"
                                    delay="1000"
                                    colors="primary:#ffffff"
                                    style="width:80px;height:80px">
                                </lord-icon>
                                <h3 class="text-2xl font-bold mt-4">Use Wi-Fi Safely</h3>
                            </div>
                            <div class="card-back bg-white text-slate-700 text-center">
                                <h4 class="font-bold">Trust No Network</h4>
                                <p class="mt-2 text-sm">Public Wi-Fi is insecure. Avoid logging into sensitive accounts. Use your mobile data or a VPN instead. Test your knowledge in our game below!</p>
                            </div>
                        </div>
                    </div>

                    <div class="card-flip h-64">
                        <div class="card-flip-inner shadow-lg rounded-xl">
                            <div class="card-front bg-slate-700 text-white">
                                <lord-icon
                                    src="https://cdn.lordicon.com/xqnbvely.json"
                                    trigger="loop"
                                    delay="1000"
                                    colors="primary:#ffffff"
                                    style="width:80px;height:80px">
                                </lord-icon>
                                <h3 class="text-2xl font-bold mt-4">Regularly Back Up Data</h3>
                            </div>
                            <div class="card-back bg-white text-slate-700 text-center">
                                <h4 class="font-bold">Ransomware Insurance</h4>
                                <p class="mt-2 text-sm">If your computer is encrypted by ransomware, a recent backup (stored separately) means you can wipe your system and recover without paying the ransom.</p>
                            </div>
                        </div>
                    </div>

                    <div class="card-flip h-64">
                        <div class="card-flip-inner shadow-lg rounded-xl">
                            <div class="card-front bg-purple-500 text-white">
                                <lord-icon
                                    src="https://cdn.lordicon.com/yxczfiyc.json"
                                    trigger="loop"
                                    delay="1000"
                                    colors="primary:#ffffff"
                                    style="width:80px;height:80px">
                                </lord-icon>
                                <h3 class="text-2xl font-bold mt-4">Filter Information</h3>
                            </div>
                            <div class="card-back bg-white text-slate-700 text-center">
                                <h4 class="font-bold">Limit Social Sharing</h4>
                                <p class="mt-2 text-sm">Be mindful of what you share online. Attackers use publicly available information (pets' names, birth dates, family names) to guess passwords or craft more convincing phishing attacks.</p>
                            </div>
                        </div>
                    </div>

                    <div class="card-flip h-64">
                        <div class="card-flip-inner shadow-lg rounded-xl">
                            <div class="card-front bg-lime-500 text-white">
                                <lord-icon
                                    src="https://cdn.lordicon.com/fpmskzsv.json"
                                    trigger="loop"
                                    delay="1000"
                                    colors="primary:#ffffff"
                                    style="width:80px;height:80px">
                                </lord-icon>
                                <h3 class="text-2xl font-bold mt-4">Use a Password Manager</h3>
                            </div>
                            <div class="card-back bg-white text-slate-700 text-center">
                                <h4 class="font-bold">Outsource Your Memory</h4>
                                <p class="mt-2 text-sm">The best way to use unique, complex passwords is to use a manager. It encrypts and stores them all, meaning you only need to remember one strong master key.</p>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Wi-Fi Drag and Drop Game -->
                <div class="mt-16 max-w-4xl mx-auto bg-slate-50 p-8 rounded-xl shadow-inner">
                    <h3 class="text-2xl font-bold text-center text-slate-800">Game: Safe or Unsafe on Public Wi-Fi?</h3>
                    <p class="text-center mt-2 text-slate-600">Drag each activity to the correct box to test your knowledge.</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8 items-start">
                        <div id="wifi-items" class="p-4 bg-white rounded-lg shadow-md space-y-3 min-h-[100px]">
                            <div draggable="true" class="wifi-item cursor-grab bg-sky-100 p-3 rounded-lg text-center font-semibold" data-safe="false">Online Banking</div>
                            <div draggable="true" class="wifi-item cursor-grab bg-sky-100 p-3 rounded-lg text-center font-semibold" data-safe="true">Streaming a Movie</div>
                            <div draggable="true" class="wifi-item cursor-grab bg-sky-100 p-3 rounded-lg text-center font-semibold" data-safe="false">Checking Work Email</div>
                            <div draggable="true" class="wifi-item cursor-grab bg-sky-100 p-3 rounded-lg text-center font-semibold" data-safe="true">Browsing News</div>
                        </div>
                        <div id="wifi-safe" class="wifi-dropzone p-4 bg-green-100 border-2 border-dashed border-green-400 rounded-lg min-h-[100px]">
                            <p class="text-center font-bold text-green-700">✅ Safe Activities</p>
                        </div>
                        <div id="wifi-unsafe" class="wifi-dropzone p-4 bg-red-100 border-2 border-dashed border-red-400 rounded-lg min-h-[100px]">
                            <p class="text-center font-bold text-red-700">❌ Unsafe Activities</p>
                        </div>
                    </div>
                    <p id="wifi-feedback" class="text-center mt-4 font-bold h-6"></p>
                </div>

            </div>
        </section>

        <!-- New Section: Live Threat Intel Feed -->
        <section id="threat-intel" class="py-16 md:py-24 bg-slate-900 text-white">
            <div class="container mx-auto px-6">
                <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-3xl md:text-4xl font-bold">Live Threat Intelligence Feed</h2>
                    <p class="mt-4 text-lg text-slate-400">Cyber attacks happen every second. This simulated feed shows recent, real-world breach types to highlight the ongoing risks. This is why your awareness matters.</p>
                </div>
                <div class="mt-12 max-w-3xl mx-auto bg-black rounded-lg shadow-2xl p-6 font-mono text-sm overflow-hidden h-48 relative">
                    <div id="threat-feed" class="absolute top-0 left-0 w-full">
                        <!-- Feed items will be injected here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Threat Playground 2: Indian Scams (Refactored) -->
        <section id="indian-scams" class="py-16 md:py-24 bg-slate-100">
            <div class="container mx-auto px-6">
                <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-800">Focus: Common Scams in India</h2>
                    <p class="mt-4 text-lg text-slate-600">These scams are responsible for significant financial loss and are tailored to the Indian digital ecosystem. Learn their patterns to stay safe.</p>
                </div>

                <div class="mt-12 bg-white rounded-xl shadow-xl overflow-hidden md:flex max-w-4xl mx-auto">
                    <!-- Vertical Navigation -->
                    <nav id="india-scams-nav" class="threat-nav bg-slate-50 md:w-1/4 flex flex-col p-4 space-y-2 border-r border-slate-200 overflow-y-auto max-h-[70vh] md:max-h-none" role="tablist" aria-label="Common Scams in India">
                        <!-- Navigation items will be injected here by JavaScript -->
                    </nav>
                    
                    <div id="india-scams-content-wrapper" class="md:w-3/4 p-6 relative min-h-[400px] overflow-hidden">
                        <!-- Content panels will be injected here by JavaScript -->
                    </div>
                </div>
            </div>
        </section>

        <section id="quiz" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-800">Test Your Knowledge</h2>
                    <p class="mt-4 text-lg text-slate-600">See how well you learned the concepts. Answer these questions based on the awareness material provided.</p>
                </div>
                <div id="quiz-container" class="mt-12 max-w-2xl mx-auto">
                    <!-- Quiz questions will be injected here by JavaScript -->
                </div>
                <div id="quiz-result" class="hidden mt-8 text-center">
                    <h3 class="text-2xl font-bold">Quiz Complete!</h3>
                    <p class="text-lg mt-2">You scored <span id="quiz-score" class="font-bold text-sky-500"></span> out of <span id="quiz-total" class="font-bold"></span>.</p>
                    <p id="quiz-feedback" class="mt-2 text-slate-600"></p>
                    <button id="quiz-retry-button" class="mt-6 bg-sky-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-sky-600 transition-all transform hover:scale-105 hover:shadow-lg">Try Again</button>
                </div>
            </div>
        </section>

        <section id="tools" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-800">Recommended Free Tools</h2>
                    <p class="mt-4 text-lg text-slate-600">These tools are what experts use daily. They offer the highest return on investment for your time and security.</p>
                </div>
                <div class="mt-12 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="bg-white p-8 rounded-lg shadow-md border-t-4 border-sky-500">
                        <h3 class="text-xl font-bold text-slate-800 flex items-center"><span class="material-symbols-outlined mr-2 text-sky-500">dns</span>Have I Been Pwned?</h3>
                        <p class="mt-3 text-slate-600">Checks if your email or phone number has been compromised in a public data breach. If found, it's an immediate signal to change that password everywhere.</p>
                        <a href="https://haveibeenpwned.com/" target="_blank" rel="noopener noreferrer" class="mt-4 inline-block font-semibold text-sky-600 hover:underline">Check Your Email &rarr;</a>
                    </div>
                    <div class="bg-white p-8 rounded-lg shadow-md border-t-4 border-teal-500">
                        <h3 class="text-xl font-bold text-slate-800"><span class="material-symbols-outlined mr-2 text-teal-500">lock</span>Password Managers</h3>
                        <p class="mt-3 text-slate-600">The safest way to use complex, unique passwords. It generates and securely stores all your keys, so you only need to remember one master password.</p>
                        <a href="https://bitwarden.com/" target="_blank" rel="noopener noreferrer" class="mt-4 inline-block font-semibold text-teal-600 hover:underline">Try Bitwarden &rarr;</a>
                    </div>
                    <div class="bg-white p-8 rounded-lg shadow-md border-t-4 border-indigo-500">
                        <h3 class="text-xl font-bold text-slate-800"><span class="material-symbols-outlined mr-2 text-indigo-500">security</span>Google Security Checkup</h3>
                        <p class="mt-3 text-slate-600">A quick, 5-minute audit of your primary Google account. It checks MFA status, recent activity, and recovery options—essential for your most critical account.</p>
                        <a href="https://myaccount.google.com/security-checkup" target="_blank" rel="noopener noreferrer" class="mt-4 inline-block font-semibold text-indigo-600 hover:underline">Google Security Checkup &rarr;</a>
                    </div>
                    <div class="bg-white p-8 rounded-lg shadow-md border-t-4 border-amber-500">
                        <h3 class="text-xl font-bold text-slate-800 flex items-center"><span class="material-symbols-outlined mr-2 text-amber-500">scanner</span>VirusTotal</h3>
                        <p class="mt-3 text-slate-600">Analyzes suspicious files and URLs to detect types of malware, automatically sharing them with the security community.</p>
                        <a href="https://www.virustotal.com/" target="_blank" rel="noopener noreferrer" class="mt-4 inline-block font-semibold text-amber-600 hover:underline">Analyze a File &rarr;</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- New Section: Report a Scam -->
         <section id="report-scam" class="py-16 bg-slate-100">
            <div class="container mx-auto px-6 text-center">
                 <h2 class="text-2xl font-bold text-slate-800"><span class="material-symbols-outlined text-red-600 text-3xl mr-2">gavel</span>Report Cybercrime in India</h2>
                 <p class="mt-3 text-slate-600 max-w-2xl mx-auto">If you believe you have been a victim of a cybercrime, report it immediately to the authorities. Quick reporting can help prevent further damage and aid investigations.</p>
                 <div class="mt-6 flex flex-wrap justify-center gap-4">
                     <a href="https://cybercrime.gov.in/" target="_blank" rel="noopener noreferrer" class="inline-block bg-red-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-red-700 transition-all transform hover:scale-105 hover:shadow-lg">National Cyber Crime Reporting Portal</a>
                     <a href="https://www.tnpolice.gov.in/CCTNSNICSDC/CitizenServices?page=ComplaintRegistration" target="_blank" rel="noopener noreferrer" class="inline-block bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all transform hover:scale-105 hover:shadow-lg">Tamil Nadu Police Cyber Cell</a>
                 </div>
                 <p class="text-xs mt-4 text-slate-500">Also consider reporting financial fraud to your bank immediately.</p>
            </div>
         </section>
    </main>

    <footer class="bg-slate-800 text-slate-400 py-8">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 Cybersecurity Awareness Initiative. All rights reserved.</p>
            <p class="text-sm mt-2">A professional service project for the Rotaract Club of Ambattur.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            // --- Global State and Constants ---
            const commonThreatsData = [
                 { // Enhanced Phishing
                    id: 'phishing-email',
                    title: 'Phishing (Email)',
                    description: 'Spot multiple red flags in a simulated phishing email designed to steal your credentials.',
                    contentHtml: `
                        <h3 class="text-2xl font-bold text-sky-500">Advanced Phishing Spotter</h3>
                        <p class="mt-2 text-slate-600">This classic attack uses an email designed to trick you. Click on all <span class="font-bold text-red-500">three red flags</span> to expose the scam.</p>
                        <div id="phishing-progress" class="mt-3 text-sm font-semibold text-slate-700">Flags Found: <span id="phishing-found-count">0</span> of 3</div>
                        <div id="phishing-alert" class="hidden mt-4 p-4 bg-red-50 border border-red-200 rounded-lg">
                            <p class="font-semibold text-red-700">Red Flag Identified!</p>
                            <p class="text-sm text-red-600 mt-1" id="phishing-alert-text"></p>
                        </div>
                        <div id="phishing-success-alert" class="hidden mt-4 p-4 bg-green-50 border border-green-200 rounded-lg">
                            <p class="font-semibold text-green-700">Excellent! All flags spotted.</p>
                            <p class="text-sm text-green-600 mt-1">You've successfully dissected this phishing attempt. This is the critical thinking needed to stay safe.</p>
                        </div>
                        <div class="grid md:grid-cols-1 gap-8 items-start mt-6"> <!-- Changed to 1 col for better focus -->
                            <div class="email-client max-w-2xl mx-auto">
                                <div class="email-header">
                                    <p class="text-sm"><span class="font-semibold">From:</span> <span class="phishing-red-flag p-1 rounded cursor-pointer hover:bg-red-100" data-flag="sender">Your Bank Security &lt;secure-alert@yourbank-online.co&gt;</span></p>
                                    <p class="text-sm mt-1"><span class="font-semibold">Subject:</span> <span class="phishing-red-flag p-1 rounded cursor-pointer hover:bg-red-100" data-flag="subject">[URGENT] Security Alert: Your Account Has Been Locked</span></p>
                                </div>
                                <div class="email-body">
                                    <p>Dear Valued Customer,</p>
                                    <p class="mt-4">We have detected suspicious activity on your account. For your protection, we have temporarily locked your access.</p>
                                    <p class="mt-4">To unlock your account and verify your identity, please click the link below and log in immediately:</p>
                                    <p class="mt-4"><span class="phishing-red-flag phishing-link p-1 rounded cursor-pointer hover:bg-red-100" data-flag="link" data-real-url="http://yourbank.com/login" data-fake-url="http://yourbank-security-verify.com/login">Click here to verify your account</span></p>
                                    <p class="mt-4">If you do not verify your account within 24 hours, it will be permanently closed.</p>
                                </div>
                            </div>
                        </div>
                    `,
                    initializer: setupPhishingEmailDemo 
                },
                { // Social Engineering
                    id: 'social-engineering',
                    title: 'Social Engineering (SE)',
                    description: 'Exploiting human psychology via OSINT, pretexting, catfishing, whaling for compromise.',
                    contentHtml: `
                        <div class="mobile-frame">
                            <div class="mobile-notch"></div>
                            <div class="mobile-screen">
                                <div id="se-chat-container" class="w-full h-full flex flex-col bg-white">
                                    
                                    <!-- App Header -->
                                    <div class="flex items-center justify-between p-3 bg-white border-b border-gray-200 shadow-sm">
                                        <button class="text-gray-500">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
                                        </button>
                                        <div class="text-center">
                                            <p class="font-bold text-lg text-gray-800">Akshay JP</p>
                                            <p class="text-xs text-green-500">Online</p>
                                        </div>
                                        <img src="profile.jpg" alt="Akshay JP" class="w-10 h-10 rounded-full">
                                    </div>

                                    <div id="se-chat-messages" class="flex-grow overflow-y-auto p-4 space-y-4 bg-gray-100">
                                        <!-- Messages will be injected here -->
                                    </div>
                                    
                                    <!-- Input Area -->
                                    <div class="p-2 bg-white border-t border-gray-200 flex items-center">
                                        <button class="text-gray-400 p-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
                                        </button>
                                        <input type="text" id="se-user-input" class="flex-grow bg-gray-100 rounded-full py-2 px-4 mx-2 text-sm" placeholder="Type a message..." disabled>
                                        <button id="se-send-btn" class="bg-pink-500 text-white p-2 rounded-full" disabled>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.428A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" /></svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `,
                    initializer: setupDatingAppDemo 
                },
                 { // Weak Passwords + Generator
                    id: 'passwords',
                    title: 'Weak Passwords',
                    description: 'Check password strength and generate strong, unique passwords.',
                    contentHtml: `
                        <div class="grid md:grid-cols-2 gap-8 items-start">
                            <div>
                                <h3 class="text-2xl font-bold text-sky-500">Password Strength & Generation</h3>
                                <p class="mt-2 text-slate-600">Weak, reused passwords are a major risk. Use the checker below, then generate a strong one.</p>
                                <!-- Strength Checker -->
                                <div class="mt-6">
                                    <h4 class="font-semibold text-slate-700 mb-2">Check Strength:</h4>
                                    <input type="text" id="password-input" class="w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500" placeholder="Type a password...">
                                    <div class="password-strength-meter mt-2"><div id="strength-bar" class="strength-bar"></div></div>
                                    <div class="flex justify-between items-center">
                                        <p id="strength-text" class="text-sm mt-2 font-medium text-slate-500"></p>
                                        <p id="time-to-crack-text" class="text-sm mt-2 font-semibold text-right"></p>
                                    </div>
                                </div>
                                <!-- Generator -->
                                <div class="mt-8 password-generator">
                                     <h4 class="font-semibold text-slate-700 mb-3">Generate a Strong Password:</h4>
                                     <div class="space-y-2 mb-3">
                                         <label for="length" class="flex items-center text-sm"><input type="range" id="pw-length" min="12" max="32" value="16" class="mr-2"> Length: <span id="pw-length-val">16</span> characters</label>
                                         <label class="flex items-center text-sm"><input type="checkbox" id="pw-uppercase" checked class="mr-2"> Uppercase (A-Z)</label>
                                         <label class="flex items-center text-sm"><input type="checkbox" id="pw-lowercase" checked class="mr-2"> Lowercase (a-z)</label>
                                         <label class="flex items-center text-sm"><input type="checkbox" id="pw-numbers" checked class="mr-2"> Numbers (0-9)</label>
                                         <label class="flex items-center text-sm"><input type="checkbox" id="pw-symbols" checked class="mr-2"> Symbols (!@#$)</label>
                                     </div>
                                     <button id="generate-pw-btn" class="bg-sky-500 text-white font-medium py-2 px-4 rounded-md hover:bg-sky-600 mr-3 transition-all transform hover:scale-105 hover:shadow-lg">Generate</button>
                                     <output id="generated-pw" class="mt-3 block"></output>
                                     <p class="text-xs text-slate-500 mt-2">*Passwords are generated client-side and are not stored.</p>
                                </div>
                            </div>
                            <div class="bg-slate-100 p-6 rounded-lg self-start"> <!-- Adjusted self-start -->
                                <h4 class="text-xl font-bold text-slate-800">Strong Password Checklist</h4>
                                <ul class="text-left mt-4 space-y-2 text-slate-700">
                                    <li id="check-length" class="checklist-item flex items-center"><lord-icon src="https://cdn.lordicon.com/zyzoecaw.json" trigger="loop" delay="1000" colors="primary:#c71f16" style="width:25px;height:25px" class="mr-2"></lord-icon>At least 12 characters</li>
                                    <li id="check-uppercase" class="checklist-item flex items-center"><lord-icon src="https://cdn.lordicon.com/zyzoecaw.json" trigger="loop" delay="1000" colors="primary:#c71f16" style="width:25px;height:25px" class="mr-2"></lord-icon>Includes Uppercase (A-Z)</li>
                                    <li id="check-lowercase" class="checklist-item flex items-center"><lord-icon src="https://cdn.lordicon.com/zyzoecaw.json" trigger="loop" delay="1000" colors="primary:#c71f16" style="width:25px;height:25px" class="mr-2"></lord-icon>Includes Lowercase (a-z)</li>
                                    <li id="check-number" class="checklist-item flex items-center"><lord-icon src="https://cdn.lordicon.com/zyzoecaw.json" trigger="loop" delay="1000" colors="primary:#c71f16" style="width:25px;height:25px" class="mr-2"></lord-icon>Includes Numbers (0-9)</li>
                                    <li id="check-symbol" class="checklist-item flex items-center"><lord-icon src="https://cdn.lordicon.com/zyzoecaw.json" trigger="loop" delay="1000" colors="primary:#c71f16" style="width:25px;height:25px" class="mr-2"></lord-icon>Includes Symbols (!@#$%)</li>
                                    <li class="mt-4 font-bold text-red-600 flex items-center"><lord-icon src="https://cdn.lordicon.com/frjgvxce.json" trigger="loop" delay="1000" colors="primary:#c71f16" style="width:25px;height:25px" class="mr-2"></lord-icon>Unique for EVERY account!</li>
                                </ul>
                            </div>
                        </div>`,
                    initializer: setupPasswordCheckerAndGenerator // Renamed initializer
                },
                 { // Malware/Ransomware
                    id: 'malware',
                    title: 'Ransomware Simulation',
                    description: 'Malicious software hidden in tempting downloads. See a simulated ransomware attack.',
                    contentHtml: `
                        <div class="relative">
                            <div id="malware-initial-screen" style="transition: opacity 0.3s;">
                                <div class="grid md:grid-cols-2 gap-8 items-start">
                                    <div>
                                        <h3 class="text-2xl font-bold text-sky-500">Simulated Ransomware Trap</h3>
                                        <p class="mt-2 text-slate-600">Attackers lure victims by offering desirable items for free. Malware like Ransomware is bundled. Click the download button to see what happens when you run a malicious file.</p>
                                    </div>
                                    <div class="bg-slate-100 p-8 rounded-lg text-center border-2 border-dashed border-slate-300">
                                        <h4 class="text-xl font-bold">Free_VPN_Installer.exe</h4>
                                        <p class="text-slate-500 text-sm">The fastest, most secure VPN!</p>
                                        <img src="https://placehold.co/100x100/e2e8f0/334155?text=🌐" alt="Installer Icon" class="mx-auto my-4 rounded-lg">
                                        <button id="malware-download-button" class="w-full bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-all transform hover:scale-105 hover:shadow-lg animate-pulse">Download & Run</button>
                                        <p class="text-xs text-slate-400 mt-2">Source: top-free-vpn-site.xyz</p>
                                    </div>
                                </div>
                            </div>
                            <div id="ransomware-screen" class="ransomware-overlay">
                                <div class="ransomware-skull">☠️</div>
                                <h2 class="text-3xl font-bold mt-4">YOUR FILES ARE ENCRYPTED!</h2>
                                <p class="mt-2">All your documents, photos, and personal files have been locked with strong encryption.</p>
                                <p class="mt-4">To get your files back, you must pay the ransom.</p>
                                <div id="ransomware-timer" class="ransomware-timer">23:59:59</div>
                                <div class="encrypted-files">
                                    <p>C:\\Users\\You\\Documents\\budget.xlsx.locked</p>
                                    <p>C:\\Users\\You\\Photos\\vacation_2025.jpg.locked</p>
                                    <p>C:\\Users\\You\\Desktop\\important_project.docx.locked</p>
                                    <p>C:\\Users\\You\\Music\\favorite_song.mp3.locked</p>
                                </div>
                                <p class="mt-4">Send 10 Bitcoin to the address below:</p>
                                <p class="font-mono bg-gray-800 p-2 rounded mt-2 text-sm">bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh</p>
                                <button id="ransomware-reset-button" class="mt-6 bg-sky-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-sky-600">Reset Simulation</button>
                            </div>
                        </div>`,
                    initializer: setupMalwareDemo 
                },
                { // Vishing
                    id: 'vishing',
                    title: 'Vishing (Phone)',
                    description: 'Voice phishing uses emotional manipulation over the phone. See a call simulation unfold.',
                    contentHtml: `
                        <div class="grid md:grid-cols-2 gap-8 items-start">
                             <div>
                                <h3 class="text-2xl font-bold text-sky-500">Vishing (Voice Phishing) Call Simulation</h3>
                                <p class="mt-2 text-slate-600">Vishing exploits trust and urgency over a phone call. Scammers impersonate banks, tech support, or government agencies. Click Start Call to see the red flags.</p>
                                <button id="vishing-start-btn" class="mt-6 bg-sky-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-sky-600 transition-all transform hover:scale-105 hover:shadow-lg">Start Call Simulation</button>
                            </div>
                            <div class="phone-call-sim">
                                <div class="flex justify-between items-center mb-4">
                                    <span class="text-green-400 font-semibold">Live Transcript</span>
                                    <span id="vishing-timer" class="text-slate-400 text-sm">00:00</span>
                                </div>
                                <div id="vishing-transcript"><p class="text-slate-500 text-center text-sm mt-8">Click Start Call to begin.</p></div>
                            </div>
                        </div>`,
                    initializer: setupVishingDemo 
                },
                 { // Mobile Security - NEW
                    id: 'mobile-security',
                    title: 'Mobile Security',
                    description: 'Key risks and protection tips specific to smartphones and tablets.',
                    contentHtml: `
                        <h3 class="text-2xl font-bold text-sky-500">Securing Your Mobile Device</h3>
                        <p class="mt-2 text-slate-600">Smartphones are powerful computers holding vast amounts of personal data, making them prime targets.</p>
                        <div class="grid md:grid-cols-2 gap-6 mt-6">
                            <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-red-500">
                                <h4 class="font-bold text-red-600">Common Mobile Risks</h4>
                                <ul class="list-disc list-inside mt-3 space-y-1 text-sm text-slate-700">
                                    <li>Malicious Apps (especially from unofficial stores)</li>
                                    <li>Smishing (SMS Phishing)</li>
                                    <li>Unsecured Wi-Fi connections</li>
                                    <li>Outdated Operating Systems</li>
                                    <li>Excessive App Permissions</li>
                                    <li>Lost or Stolen Devices</li>
                                </ul>
                            </div>
                             <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-green-500">
                                <h4 class="font-bold text-green-600">Essential Mobile Defenses</h4>
                                <ul class="list-disc list-inside mt-3 space-y-1 text-sm text-slate-700">
                                    <li>Use strong screen lock (PIN, Biometric)</li>
                                    <li>Install apps ONLY from official stores (Play Store, App Store)</li>
                                    <li>Review app permissions carefully before granting</li>
                                    <li>Keep OS and apps updated</li>
                                    <li>Enable 'Find My Device' features</li>
                                    <li>Be wary of public Wi-Fi; use VPN or mobile data</li>
                                    <li>Don't click links or download attachments in suspicious SMS/Messages</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-6 bg-yellow-50 p-4 rounded-lg border border-yellow-200 text-sm text-yellow-800">
                           <span class="font-bold">Tip:</span> Regularly check which apps have access to your location, camera, and microphone in your phone's settings. Revoke permissions for apps that don't need them.
                        </div>
                        `,
                    initializer: null // No specific JS needed for this static content
                },
                 { // Privacy Basics - NEW
                    id: 'privacy-basics',
                    title: 'Privacy Basics',
                    description: 'Understanding how your data is collected online and steps to protect your privacy.',
                    contentHtml: `
                        <h3 class="text-2xl font-bold text-sky-500">Understanding Digital Privacy</h3>
                        <p class="mt-2 text-slate-600">While related to security, privacy focuses on controlling who collects and uses your personal information online.</p>
                        
                        <h4 class="text-xl font-bold text-slate-800 mt-6">How Your Data is Collected</h4>
                         <ul class="list-disc list-inside mt-3 space-y-1 text-sm text-slate-700 bg-white p-4 rounded shadow-sm">
                             <li><strong>Tracking Cookies:</strong> Small files websites place on your browser to track your activity across sites for targeted advertising.</li>
                             <li><strong>App Permissions:</strong> Mobile apps requesting access to contacts, location, camera, etc., sometimes more than needed.</li>
                             <li><strong>Social Media Sharing:</strong> Information you voluntarily post (location tags, personal details, photos).</li>
                             <li><strong>Data Brokers:</strong> Companies that aggregate and sell personal information collected from various public and private sources.</li>
                             <li><strong>Website Analytics:</strong> Tools used by site owners to understand visitor behavior.</li>
                         </ul>

                        <h4 class="text-xl font-bold text-slate-800 mt-6">Steps to Enhance Privacy</h4>
                         <ul class="list-disc list-inside mt-3 space-y-1 text-sm text-slate-700 bg-white p-4 rounded shadow-sm">
                             <li><strong>Review Privacy Settings:</strong> Regularly check and adjust settings on social media, search engines, and browsers.</li>
                             <li><strong>Use Privacy-Focused Browsers/Extensions:</strong> Tools like DuckDuckGo, Brave, or extensions like uBlock Origin can block trackers.</li>
                             <li><strong>Limit App Permissions:</strong> Only grant permissions essential for an app's function.</li>
                             <li><strong>Be Mindful of Sharing:</strong> Think twice before posting sensitive personal details online.</li>
                             <li><strong>Use VPNs on Public Wi-Fi:</strong> Encrypts your connection, hiding your activity from network snoopers.</li>
                             <li><strong>Clear Cookies Regularly:</strong> Reduces cross-site tracking.</li>
                         </ul>
                         <p class="mt-4 text-xs text-slate-500 italic"> Privacy is about controlling your digital footprint.</p>
                         `,
                    initializer: null
                },
                 { // Qishing - NEW
                    id: 'qishing',
                    title: 'Qishing (QR Code Phishing)',
                    description: 'Using malicious QR codes to direct users to phishing sites or trigger malicious actions.',
                    contentHtml: `
                         <h3 class="text-2xl font-bold text-amber-600">Emerging Threat: Qishing (QR Code Phishing)</h3>
                         <p class="mt-2 text-slate-600">QR codes are convenient but can be easily weaponized. Scammers replace legitimate QR codes (on posters, menus, payment terminals) with malicious ones.</p>
                         <div class="grid md:grid-cols-2 gap-6 mt-6 items-center">
                             <div>
                                 <h4 class="text-lg font-bold text-slate-800">How Qishing Works:</h4>
                                 <ul class="list-decimal list-inside mt-3 space-y-1 text-sm text-slate-700">
                                     <li>Attacker places a malicious QR code sticker over a real one.</li>
                                     <li>Victim scans the code expecting a legitimate action (e.g., view menu, make payment).</li>
                                     <li>The malicious code directs the victim's phone browser to:
                                         <ul class="list-disc list-inside ml-4">
                                             <li>A phishing website mimicking a login page.</li>
                                             <li>A site initiating a malware download.</li>
                                             <li>A fake payment portal.</li>
                                             <li>A site initiating a call or message to a premium number.</li>
                                         </ul>
                                     </li>
                                 </ul>
                                  <h4 class="text-lg font-bold text-slate-800 mt-4">Defenses:</h4>
                                  <ul class="list-disc list-inside mt-3 space-y-1 text-sm text-green-700 font-medium">
                                      <li>Be wary of QR codes in unexpected public places or emails.</li>
                                      <li>Preview the URL before opening if your scanner app allows. Does it look legitimate?</li>
                                      <li>Avoid scanning codes on tampered posters/stickers.</li>
                                      <li>Never enter login credentials or payment info after scanning a public QR code unless you are certain of its authenticity.</li>
                                  </ul>
                             </div>
                             <div class="text-center">
                                 <img src="rickroll_qr.png" alt="Sample QR Code" class="mx-auto qr-code-img">
                                 <p class="text-xs text-slate-500 mt-2">Could this QR code be malicious?</p>
                                 <button id="qishing-scan-btn" class="mt-4 bg-sky-500 text-white font-medium py-2 px-4 rounded-md hover:bg-sky-600 transition-all transform hover:scale-105 hover:shadow-lg">Simulate Scan</button>
                                 <div id="qishing-alert" class="hidden mt-3 p-3 bg-red-100 border border-red-300 rounded text-sm text-red-700">
                                     <strong>Danger!</strong> The scanned URL is <code class="font-mono bg-red-200 px-1 rounded">http://totally-not-a-scam-login.xyz</code>. This looks suspicious!
                                 </div>
                             </div>
                         </div>
                         `,
                    initializer: setupQishingDemo
                },
                { // Live Phishing Demo - MOVED
                    id: 'live-phishing',
                    title: 'Live Phishing Demo',
                    description: 'A live, safe simulation of credential theft. See how quickly data is stolen.',
                    contentHtml: `
                        <h3 class="text-2xl font-bold text-red-500">Live Attack Demo: Phishing Data Theft</h3>
                        <p class="mt-2 text-slate-600">This is a <span class="font-bold">safe and simulated</span> demo. The page below is designed to look like a real login page. Enter any fake credentials to see what happens the moment you click 'Log In' on a malicious site. No data is stored or sent.</p>
                        <div class="mt-6 max-w-md mx-auto flex flex-col items-center">
                            <!-- Main Login Box -->
                            <div id="phishing-form-container" class="bg-white border border-slate-300 rounded-lg p-10 w-full max-w-sm transition-all duration-500">
                                <!-- Instagram Logo -->
                                <div class="flex justify-center mb-8">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Instagram_logo.svg/1200px-Instagram_logo.svg.png" alt="Instagram" class="h-10 w-auto">
                                </div>
                                <form id="phishing-form" class="mt-6 space-y-2">
                                    <div>
                                        <input type="text" id="phishing-email" class="w-full px-2 py-2 bg-slate-50 border border-slate-300 rounded-sm text-xs focus:outline-none focus:ring-1 focus:ring-slate-400" placeholder="Phone number, username, or email" required>
                                    </div>
                                    <div>
                                        <input type="password" id="phishing-password" class="w-full px-2 py-2 bg-slate-50 border border-slate-300 rounded-sm text-xs focus:outline-none focus:ring-1 focus:ring-slate-400" placeholder="Password" required>
                                    </div>
                                    <button type="submit" class="w-full bg-sky-500 text-white font-bold text-sm py-1.5 rounded-lg hover:bg-sky-600 transition-all mt-4">Log In</button>
                                </form>
                                <div class="flex items-center my-6">
                                    <div class="flex-grow border-t border-slate-300"></div>
                                    <span class="px-4 text-xs font-semibold text-slate-500">OR</span>
                                    <div class="flex-grow border-t border-slate-300"></div>
                                </div>
                                <div class="text-center">
                                    <button class="text-sm font-semibold text-indigo-900">
                                        <svg aria-hidden="true" class="inline w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 112 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>
                                        Log in with Facebook
                                    </button>
                                </div>
                                <a href="#" class="block text-center mt-4 text-xs text-indigo-900">Forgot password?</a>
                            </div>
                            <!-- Sign Up Box -->
                            <div class="bg-white border border-slate-300 rounded-lg p-6 w-full max-w-sm mt-4 text-center text-sm">
                                <p>Don't have an account? <a href="#" class="font-semibold text-sky-500">Sign up</a></p>
                            </div>
                            <!-- Get the App Box -->
                            <div class="text-center w-full max-w-sm mt-4 text-sm">
                                <p>Get the app.</p>
                                <div class="flex justify-center gap-4 mt-4">
                                    <img src="https://static.cdninstagram.com/rsrc.php/v3/yz/r/c5Rp7Ym-Klz.png" alt="Get it on Google Play" class="h-10">
                                    <img src="https://static.cdninstagram.com/rsrc.php/v3/yu/r/EHY6QnZYdNX.png" alt="Get it from Microsoft" class="h-10">
                                </div>
                            </div>
                            <div id="phishing-result" class="hidden bg-slate-900 border-l-4 border-red-500 p-6 rounded-lg shadow-xl text-slate-300 w-full max-w-sm mt-4">
                                <h3 class="text-2xl font-bold text-red-500 flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 3.001-1.742 3.001H4.42c-1.53 0-2.493-1.667-1.743-3.001l5.58-9.92zM10 13a1 1 0 110-2 1 1 0 010 2zm-1-8a1 1 0 00-1 1v3a1 1 0 112 0V6a1 1 0 00-1-1z" clip-rule="evenodd" /></svg> Access Intercepted!</h3>
                                <p class="mt-2">This is the simulated attacker log showing the successful theft:</p>
                                <div class="mt-4 bg-black text-white p-4 rounded-md font-mono text-sm break-all shadow-inner">
                                    <div id="typing-animation" class="flex items-start">
                                        <span class="text-green-400 mr-2 flex-shrink-0">&gt;</span>
                                        <span id="typing-text"></span>
                                        <span class="animate-ping flex-shrink-0 text-white ml-0.5" id="typing-cursor">_</span>
                                    </div>
                                </div>
                                <p class="mt-4 text-sm">The Takeaway: This attack works because it bypasses technical defenses. Your best protection? Never enter a password after clicking a link in an email. Go to the official site directly.</p>
                                <button id="reset-demo" class="mt-6 text-sm font-semibold text-sky-400 hover:underline">Try the demo again</button>
                            </div>
                        </div>
                    `,
                    initializer: setupLivePhishingDemo
                },
                { // Credential Stuffing - NEW
                    id: 'credential-stuffing',
                    title: 'Credential Stuffing',
                    description: 'How hackers use lists of leaked passwords to break into other accounts.',
                    contentHtml: `
                        <h3 class="text-2xl font-bold text-red-500">Attack Demo: Credential Stuffing</h3>
                        <p class="mt-2 text-slate-600">After a data breach, hackers take lists of emails and passwords and try them on many other websites. This is called credential stuffing. It works because people reuse passwords.</p>
                        <div class="grid md:grid-cols-2 gap-8 items-start mt-6">
                            <div class="bg-slate-100 p-4 rounded-lg">
                                <h4 class="font-bold text-slate-800">Leaked Credentials from "MyFitnessApp"</h4>
                                <p class="text-xs text-slate-500 mb-2">A list of email/password pairs from a recent breach.</p>
                                <div id="leaked-data-list" class="font-mono text-xs space-y-1 h-64 overflow-y-auto bg-white p-2 rounded shadow-inner">
                                    <!-- Leaked data will be injected here -->
                                </div>
                            </div>
                            <div class="relative">
                                <h4 class="font-bold text-slate-800">Attacking "YourBank" Login</h4>
                                <p class="text-xs text-slate-500 mb-2">The script will now try each leaked password against the bank's login page.</p>
                                <div id="attack-log" class="font-mono text-xs space-y-1 h-64 overflow-y-auto bg-slate-900 text-white p-3 rounded shadow-inner">
                                    <p class="text-gray-400">Click "Start Attack" to begin...</p>
                                </div>
                                <button id="start-stuffing-attack" class="mt-4 w-full bg-red-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-600 transition-all">Start Attack</button>
                            </div>
                        </div>
                    `,
                    initializer: setupCredentialStuffingDemo
                },
                { // Malicious App Permissions - NEW
                    id: 'app-permissions',
                    title: 'Malicious App Permissions',
                    description: 'See how apps spy on you by requesting unnecessary permissions.',
                    contentHtml: `
                        <h3 class="text-2xl font-bold text-red-500">Demo: Malicious App Permissions</h3>
                        <p class="mt-2 text-slate-600">You are installing a "Simple Photo Editor" app. Pay close attention to the permissions it requests. Is it asking for more than it needs?</p>
                        <div class="mt-6 flex justify-center">
                            <div class="mobile-frame" style="height: 680px;">
                                <div class="mobile-notch"></div>
                                <div id="app-permission-screen" class="mobile-screen bg-gray-800 justify-center items-center p-4 text-center">
                                    <!-- Demo content will be injected here -->
                                </div>
                            </div>
                        </div>
                    `,
                    initializer: setupAppPermissionsDemo
                },
            ]; // End commonThreatsData

             const indiaScamsData = [
                { // UPI
                    id: 'upi',
                    title: 'UPI "Collect Request"',
                    description: 'Scammer sends a Collect Request, claiming it\'s a refund, tricking user into sending money.',
                    contentHtml: `
                        <div class="grid md:grid-cols-2 gap-8 items-start">
                            <div>
                                <h3 class="text-2xl font-bold text-red-600">UPI "Collect Request" Scam</h3>
                                <p class="mt-2 text-slate-600">Scammer sends a payment request disguised as a refund, creating urgency to make you approve without thinking. Click "Approve" to see the warning.</p>
                                <ul class="mt-4 space-y-2 text-sm">
                                    <li><span class="font-bold text-red-600">The Lie:</span> "Sir, approve the request and enter PIN to receive ₹5,000 refund."</li>
                                    <li><span class="font-bold text-green-600">The Truth:</span> PIN is NEVER needed to *receive* money via UPI.</li>
                                </ul>
                            </div>
                            <div class="bg-slate-800 p-6 rounded-lg text-white font-mono">
                                <div class="text-center mb-4"><p class="text-lg font-bold">Payment Request</p><p class="text-sm text-slate-400">From: "Customer Support" (UNKNOWN)</p></div>
                                <p class="text-5xl font-bold text-center text-amber-400">₹ 5,000.00</p>
                                <div class="mt-6 flex space-x-4">
                                    <button id="upi-decline" class="w-full bg-slate-600 py-3 rounded-lg hover:bg-slate-500 transition-all transform hover:scale-105 hover:shadow-lg">Decline</button>
                                    <button id="upi-approve" class="w-full bg-green-500 py-3 rounded-lg hover:bg-green-400 transition-all transform hover:scale-105 hover:shadow-lg">Approve</button>
                                </div>
                                <p id="upi-alert" class="hidden mt-4 text-center text-red-400 font-bold">Warning: Approving this SENDS money!</p>
                            </div>
                        </div>`,
                    initializer: setupUpiDemo 
                },
                { // Digital Arrest
                    id: 'arrest',
                    title: '"Digital Arrest"',
                    description: 'Impersonating police/CBI via video call to extort money under threat of fake legal action.',
                    contentHtml: `
                        <div class="grid md:grid-cols-2 gap-8 items-start">
                            <div>
                                <h3 class="text-2xl font-bold text-red-600">"Digital Arrest" Impersonation</h3>
                                <p class="mt-2 text-slate-600">Scammers impersonate police/CBI, creating extreme fear via video call to extort money, isolating the victim.</p>
                                <ul class="mt-4 space-y-2 text-sm">
                                    <li><span class="font-bold text-red-600">The Threat:</span> "Illegal items seized in your name. You are under digital arrest. Do not disconnect."</li>
                                    <li><span class="font-bold text-green-600">The Defense:</span> Real law enforcement does NOT operate via WhatsApp video calls. Hang up immediately.</li>
                                </ul>
                            </div>
                            <div class="bg-black p-6 rounded-lg text-white font-mono flex flex-col items-center justify-center h-full min-h-[300px]">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-red-500 animate-pulse" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" /></svg>
                                <p class="mt-4 text-center text-red-400">CALL FROM "CBI OFFICIAL"</p>
                                <p class="mt-2 text-center text-slate-300">"DO NOT DISCONNECT. YOUR LINE IS MONITORED."</p>
                            </div>
                        </div>`,
                    initializer: null 
                },
                { // Smishing - FIXED
                    id: 'smishing',
                    title: 'Smishing + Malicious APKs',
                    description: 'Phishing via SMS with links to download malicious `.apk` files or fake login pages.',
                    contentHtml: `
                        <div class="grid md:grid-cols-2 gap-8 items-start">
                            <div>
                                <h3 class="text-2xl font-bold text-red-600">Smishing + Malicious APKs</h3>
                                <p class="mt-2 text-slate-600">SMS about failed delivery/blocked account contains a link. Clicking might download a malicious ".apk" file to steal OTPs/data.</p> 
                                <ul class="mt-4 space-y-2 text-sm">
                                    <li><span class="font-bold text-red-600">The Trap:</span> "Package on hold. Update: bit.ly/track-now-3a.apk"</li>
                                    <li><span class="font-bold text-green-600">The Defense:</span> NEVER install apps from SMS links. Use official app stores only.</li>
                                </ul>
                            </div>
                             <div class="bg-slate-200 p-4 rounded-lg min-h-[300px] flex flex-col items-center justify-center relative">
                                <div class="bg-white p-3 rounded-lg shadow-sm w-full max-w-sm">
                                    <p class="text-sm"><span class="font-bold">IN-POST:</span> Dear Customer, your parcel delivery failed due to address issue. Update now: <a href="#" id="smishing-link" class="text-blue-600 underline">http://indiapost-parceltrack.xyz/update</a></p>
                                </div>
                                <div id="smishing-alert" class="hidden absolute bottom-4 p-3 bg-red-100 border border-red-300 rounded text-center text-red-600 font-bold text-sm">
                                    DANGER! This link likely leads to malware or a phishing site.
                                </div>
                            </div>
                        </div>`,
                    initializer: setupSmishingDemo 
                }
            ]; // End indiaScamsData

            // --- Menu & Navigation Initialization ---
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenuButton.addEventListener('click', () => {
                if (mobileMenu.classList.contains('hidden')) {
                    mobileMenu.classList.remove('hidden');
                    // The following is a trick to trigger the transition
                    requestAnimationFrame(() => {
                        mobileMenu.style.maxHeight = mobileMenu.scrollHeight + 'px';
                        mobileMenu.style.opacity = '1';
                    });
                } else {
                    mobileMenu.style.maxHeight = '0';
                    mobileMenu.style.opacity = '0';
                    mobileMenu.addEventListener('transitionend', () => {
                        mobileMenu.classList.add('hidden');
                    }, { once: true });
                }
            });
            
            // Add initial styles for transition
            mobileMenu.style.maxHeight = '0';
            mobileMenu.style.opacity = '0';
            
            const navLinks = document.querySelectorAll('.nav-link, #mobile-menu a');
            const sections = document.querySelectorAll('main section');
            
            function setActiveLink() {
                let current = 'home';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                     // Adjust offset based on header height (approx 60-70px)
                    if (window.scrollY >= sectionTop - 70) {
                        current = section.getAttribute('id');
                    }
                });
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    // Check if the link's href contains the current section ID
                    if (link.getAttribute('href') === `#${current}`) {
                        link.classList.add('active');
                    }
                });
            }
            window.addEventListener('scroll', setActiveLink);
            setActiveLink(); // Initial call

            // --- Chart.js Initialization ---
            const attackCtx = document.getElementById('attackVectorChart').getContext('2d');
            new Chart(attackCtx, { 
                type: 'doughnut',
                data: {
                    labels: ['Phishing/Social Engineering (90%)', 'Malware (5%)', 'Weak/Stolen Credentials (3%)', 'Other (2%)'],
                    datasets: [{
                        label: 'Initial Attack Vectors',
                        data: [90, 5, 3, 2],
                        backgroundColor: ['#0ea5e9', '#14b8a6', '#f43f5e', '#64748b'],
                        borderColor: '#f8fafc',
                        borderWidth: 4,
                        hoverOffset: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom', labels: { color: '#475569', padding: 20, font: { family: "'Inter', sans-serif" } } }, tooltip: { callbacks: { label: (context) => context.label } } },
                    cutout: '60%'
                }
             }); 

            // --- Threat Playground Core Logic ---
            function initializeThreatPlayground(navId, contentWrapperId, data) {
                 const navElement = document.getElementById(navId);
                const contentWrapperElement = document.getElementById(contentWrapperId);

                if (!navElement || !contentWrapperElement) {
                    console.error("Playground elements not found:", navId, contentWrapperId);
                    return;
                }

                navElement.innerHTML = ''; // Clear previous nav
                contentWrapperElement.innerHTML = ''; // Clear previous content

                let firstThreatId = data.length > 0 ? data[0].id : null;

                data.forEach((threat, index) => {
                    // 1. Create Navigation Item
                    const navItem = document.createElement('div');
                    navItem.className = `threat-nav-item p-3 ${index === 0 ? 'active' : ''}`;
                    navItem.setAttribute('data-threat-id', threat.id);
                    navItem.setAttribute('role', 'tab');
                    navItem.setAttribute('aria-selected', index === 0 ? 'true' : 'false');
                    navItem.setAttribute('aria-controls', `panel-${navId}-${threat.id}`); // Unique ID
                    navItem.id = `tab-${navId}-${threat.id}`; // Unique ID
                    navItem.innerHTML = `<p class="text-sm">${threat.title}</p><p class="text-xs text-slate-500 font-normal mt-0.5">${threat.description.substring(0, 50)}...</p>`;
                    navElement.appendChild(navItem);

                    // 2. Create Content Panel
                    const contentPanel = document.createElement('div');
                    contentPanel.id = `panel-${navId}-${threat.id}`; // Match aria-controls
                    contentPanel.className = `threat-content ${index === 0 ? 'active' : ''}`;
                    contentPanel.setAttribute('role', 'tabpanel');
                    contentPanel.setAttribute('aria-labelledby', `tab-${navId}-${threat.id}`); // Match nav item ID
                    contentPanel.setAttribute('tabindex', '0');
                    contentPanel.innerHTML = threat.contentHtml;
                    contentPanel.style.visibility = index === 0 ? 'visible' : 'hidden'; // Control initial visibility
                    contentWrapperElement.appendChild(contentPanel);

                    // 3. Attach Event Listener
                    navItem.addEventListener('click', () => {
                        showThreatContent(navId, contentWrapperId, threat.id, data);
                    });
                });

                // Set initial active state and run initializer
                if (firstThreatId) {
                    showThreatContent(navId, contentWrapperId, firstThreatId, data, true); // Pass initial flag
                }
            }

            function showThreatContent(navId, contentWrapperId, threatId, data, isInitial = false) {
                 const navElement = document.getElementById(navId);
                const contentWrapperElement = document.getElementById(contentWrapperId);
                const contentPanels = contentWrapperElement.querySelectorAll('.threat-content');
                const navItems = navElement.querySelectorAll('.threat-nav-item');

                // Update Navigation
                navItems.forEach(item => {
                    const isActive = item.getAttribute('data-threat-id') === threatId;
                    item.classList.toggle('active', isActive);
                    item.setAttribute('aria-selected', isActive ? 'true' : 'false');
                });

                // Switch Content Panel
                contentPanels.forEach(panel => {
                    const isActive = panel.id === `panel-${navId}-${threatId}`;
                    panel.classList.remove('active'); // Remove first
                    panel.style.visibility = 'hidden'; // Hide immediately

                    if (isActive) {
                         // Function to make panel active and visible
                        const activatePanel = () => {
                            panel.style.visibility = 'visible'; // Make visible first
                            requestAnimationFrame(() => { // Ensure visibility is applied before transition starts
                                panel.classList.add('active'); // Then trigger transition
                            });

                             // Run Demo Initializer
                            const threat = data.find(t => t.id === threatId);
                            if (threat && typeof threat.initializer === 'function') {
                                // console.log("Initializing demo for:", threatId);
                                try {
                                    threat.initializer();
                                } catch (error) {
                                    console.error("Error initializing demo for", threatId, error);
                                }
                            }
                        };
                        
                        // Apply active class (with delay only if not initial load for smoother transition)
                        if (isInitial) {
                            activatePanel(); // No delay on initial load
                        } else {
                            setTimeout(activatePanel, 50); // Small delay allows fade-out before fade-in
                        }
                    }
                });
            }


            // --- Demo Initializer Functions ---

             // Advanced Phishing Email Demo
            function setupPhishingEmailDemo() {
                const phishingFlags = document.querySelectorAll(`#panel-common-threats-nav-phishing-email .phishing-red-flag`); // Scope query
                const phishingAlert = document.getElementById(`panel-common-threats-nav-phishing-email`).querySelector('#phishing-alert');
                const phishingAlertText = document.getElementById(`panel-common-threats-nav-phishing-email`).querySelector('#phishing-alert-text');
                const phishingSuccessAlert = document.getElementById(`panel-common-threats-nav-phishing-email`).querySelector('#phishing-success-alert');
                const phishingFoundCount = document.getElementById(`panel-common-threats-nav-phishing-email`).querySelector('#phishing-found-count');

                if(!phishingFlags.length || !phishingAlert || !phishingSuccessAlert) {
                    // console.warn("Phishing demo elements not found. Already initialized or issue with panel ID?");
                    return; // Prevent errors if elements aren't ready
                }

                let foundFlags = new Set();
                phishingFoundCount.textContent = '0'; // Reset count
                phishingAlert.classList.add('hidden');
                phishingSuccessAlert.classList.add('hidden');
                phishingFlags.forEach(f => f.classList.remove('found', 'pointer-events-none')); // Reset visual state


                // Use event delegation or reattach listeners
                phishingFlags.forEach(flag => {
                     // Clone and replace to remove old listeners if re-initializing
                     const newFlag = flag.cloneNode(true);
                     flag.parentNode.replaceChild(newFlag, flag);

                     newFlag.addEventListener('click', (e) => {
                        e.preventDefault();
                        const flagType = newFlag.dataset.flag;

                        if (foundFlags.has(flagType)) return; // Already found

                        foundFlags.add(flagType);
                        newFlag.classList.add('found', 'pointer-events-none');
                        phishingFoundCount.textContent = foundFlags.size;
                        
                        let alertMessage = '';
                        switch(flagType) {
                            case 'sender': alertMessage = "<strong>Sender's Domain:</strong> The email is from 'yourbank-online.co', not a legitimate bank domain. Scammers often buy slightly incorrect domain names."; break;
                            case 'subject': alertMessage = "<strong>Urgent Subject Line:</strong> The word 'URGENT' is used to create panic and rush you into making a mistake."; break;
                            case 'link': alertMessage = "<strong>Mismatched Link:</strong> Hovering over the link would show it leads to 'yourbank-security-verify.com', not the official site."; break;
                        }
                        phishingAlertText.innerHTML = alertMessage;
                        phishingAlert.classList.remove('hidden');

                        if (foundFlags.size === 3) {
                            phishingAlert.classList.add('hidden');
                            phishingSuccessAlert.classList.remove('hidden');
                        }
                    });

                     // Add hover effect for link flag
                    if (newFlag.dataset.flag === 'link') {
                        newFlag.addEventListener('mouseover', () => {
                             if (!foundFlags.has('link')) {
                                newFlag.title = `WARNING: Link leads to: ${newFlag.dataset.fakeUrl}`;
                             }
                        });
                        newFlag.addEventListener('mouseout', () => {
                           newFlag.title = '';
                        });
                    }
                });
            }

            // Social Engineering Demo (Dating App)
            function setupDatingAppDemo() {
                const panel = document.getElementById('panel-common-threats-nav-social-engineering');
                if (!panel) return;
                
                const chatMessages = panel.querySelector('#se-chat-messages');
                const userInput = panel.querySelector('#se-user-input');
                const sendBtn = panel.querySelector('#se-send-btn');
                const chatContainer = panel.querySelector('#se-chat-container');

                if (!chatMessages || !userInput || !sendBtn || !chatContainer) return;

                let conversationState = 0;
                const conversation = [
                    { from: 'scammer', text: "Hey! Saw we matched. Your profile is amazing. You seem to love Chennai as much as I do!", delay: 1000 },
                    { from: 'user', options: ["Haha thanks! Yeah, Chennai is home.", "Thanks! You have a great smile."], delay: 0 },
                    { from: 'scammer', text: "Totally! We should go for a walk at Bessy Beach sometime. But listen, this is a bit forward... I feel a real connection. Can I get your full name and email so we can chat off this app?", delay: 2000 },
                    { from: 'user', options: ["I'd rather chat here for a bit first.", "Sure, my email is my.email@example.com"], delay: 0 },
                    { from: 'scammer', text: "No problem, totally understand! Safety first. :)", isGood: true, delay: 1500 },
                    { from: 'scammer', text: "Great! I'll email you. What's your mother's maiden name? It's for a silly security question on a game we could play.", isBad: true, delay: 1500 }
                ];

                function addMessage(from, text, isAlert = false) {
                    const messageDiv = document.createElement('div');
                    const messageContainer = document.createElement('div');
                    messageContainer.className = `flex w-full ${from === 'scammer' ? 'justify-start' : 'justify-end'}`;
                    
                    if (isAlert) {
                        messageDiv.className = 'p-3 rounded-lg bg-red-100 text-red-700 text-sm font-semibold self-center w-full text-center my-2';
                        messageDiv.innerHTML = text;
                        chatMessages.appendChild(messageDiv);
                    } else {
                        messageDiv.className = `chat-bubble-pop-in max-w-xs md:max-w-md p-3 rounded-2xl ${from === 'scammer' ? 'bg-gray-200' : 'bg-pink-500 text-white'}`;
                        messageDiv.innerHTML = text;
                        messageContainer.appendChild(messageDiv);
                        chatMessages.appendChild(messageContainer);
                    }
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }

                function showTypingIndicator() {
                    const typingDiv = document.createElement('div');
                    typingDiv.className = 'typing-indicator self-start flex items-center p-3';
                    typingDiv.innerHTML = '<div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center mr-2 flex-shrink-0"><lord-icon src="https://cdn.lordicon.com/jnzbbhgc.json" trigger="loop" colors="primary:#9ca3af" style="width:20px;height:20px"></lord-icon></div><span></span><span></span><span></span>';
                    chatMessages.appendChild(typingDiv);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    return typingDiv;
                }

                function showOptions(options) {
                    // Clear previous options
                    const existingOptions = chatContainer.querySelector('.options-container');
                    if(existingOptions) existingOptions.remove();

                    const optionsContainer = document.createElement('div');
                    optionsContainer.className = 'options-container p-2 bg-white border-t border-gray-200 flex flex-wrap gap-2 justify-center';
                    
                    options.forEach((optionText, index) => {
                        const button = document.createElement('button');
                        button.className = 'bg-sky-100 text-sky-800 text-sm font-medium py-2 px-3 rounded-full hover:bg-sky-200 transition-colors';
                        button.textContent = optionText;
                        button.onclick = () => {
                            addMessage('user', optionText);
                            optionsContainer.remove();
                            
                            // Logic for branching conversation
                            if (conversationState === 3 && index === 1) { // User gave email
                                conversationState = 5; // Jump to bad question
                                setTimeout(() => addMessage('scammer', "You've shared personal info! This can be used in other scams. Be careful!", true), 1000);
                            } else {
                                conversationState++;
                            }
                            
                            processStep();
                        };
                        optionsContainer.appendChild(button);
                    });
                    chatContainer.appendChild(optionsContainer);
                }

                function processStep() {
                    if (conversationState >= conversation.length) {
                        setTimeout(() => {
                            addMessage('scammer', "This conversation has ended. Thanks for playing!", true);
                            setTimeout(startDemo, 5000);
                        }, 2000);
                        return;
                    }

                    const step = conversation[conversationState];
                    
                    if (step.from === 'scammer') {
                        const typingIndicator = showTypingIndicator();
                        setTimeout(() => {
                            if(chatMessages.contains(typingIndicator)) {
                                chatMessages.removeChild(typingIndicator);
                            }
                            addMessage('scammer', step.text);
                            conversationState++;
                            processStep();
                        }, step.delay);
                    } else { // 'user'
                        showOptions(step.options);
                    }
                }

                function startDemo() {
                    chatMessages.innerHTML = '';
                    const existingOptions = chatContainer.querySelector('.options-container');
                    if(existingOptions) existingOptions.remove();
                    conversationState = 0;
                    processStep();
                }

                startDemo();
            }

            // Password Checker and Generator with Time to Crack
            function setupPasswordCheckerAndGenerator() {
                const panel = document.getElementById('panel-common-threats-nav-passwords');
                if (!panel) return;

                const passwordInput = panel.querySelector('#password-input');
                const strengthBar = panel.querySelector('#strength-bar');
                const strengthText = panel.querySelector('#strength-text');
                const timeToCrackText = panel.querySelector('#time-to-crack-text');
                const checks = {
                    length: panel.querySelector('#check-length'), uppercase: panel.querySelector('#check-uppercase'),
                    lowercase: panel.querySelector('#check-lowercase'), number: panel.querySelector('#check-number'),
                    symbol: panel.querySelector('#check-symbol'),
                };
                
                const lengthSlider = panel.querySelector('#pw-length');
                const lengthVal = panel.querySelector('#pw-length-val');
                const uppercaseCheck = panel.querySelector('#pw-uppercase');
                const lowercaseCheck = panel.querySelector('#pw-lowercase');
                const numbersCheck = panel.querySelector('#pw-numbers');
                const symbolsCheck = panel.querySelector('#pw-symbols');
                const generateBtn = panel.querySelector('#generate-pw-btn');
                const generatedPwOutput = panel.querySelector('#generated-pw');
                
                 if (!passwordInput || !strengthBar || !strengthText || !timeToCrackText || !generateBtn || !generatedPwOutput || !lengthSlider) return;


                // --- Strength Checker Logic ---
                const newPasswordInput = passwordInput.cloneNode(true);
                passwordInput.parentNode.replaceChild(newPasswordInput, passwordInput);

                newPasswordInput.addEventListener('input', () => {
                    const password = newPasswordInput.value;
                    let score = 0;
                    const criteria = {
                        length: password.length >= 12,
                        uppercase: /[A-Z]/.test(password),
                        lowercase: /[a-z]/.test(password),
                        number: /[0-9]/.test(password),
                        symbol: /[^A-Za-z0-9]/.test(password)
                    };

                    let fulfilled = 0;
                    let characterPool = 0;
                    if (criteria.lowercase) { characterPool += 26; fulfilled++; }
                    if (criteria.uppercase) { characterPool += 26; fulfilled++; }
                    if (criteria.number) { characterPool += 10; fulfilled++; }
                    if (criteria.symbol) { characterPool += 32; fulfilled++; }
                    if (criteria.length) { fulfilled++; }
                    
                    score = fulfilled;

                    Object.keys(criteria).forEach(key => {
                        const checkEl = checks[key];
                        const icon = checkEl.querySelector('lord-icon');
                        if (criteria[key]) {
                            if (!checkEl.classList.contains('checked')) {
                                checkEl.classList.add('checked');
                                if (icon) {
                                    icon.src = 'https://cdn.lordicon.com/lupuorrc.json';
                                    icon.colors = 'primary:#16a34a';
                                    icon.trigger = 'in';
                                    setTimeout(() => icon.play(), 100);
                                }
                            }
                        } else {
                            if (checkEl.classList.contains('checked')) {
                                checkEl.classList.remove('checked');
                                if (icon) {
                                    icon.src = 'https://cdn.lordicon.com/zyzoecaw.json';
                                    icon.colors = 'primary:#c71f16';
                                    icon.trigger = 'loop';
                                }
                            }
                        }
                    });

                    const width = (score / 5) * 100;
                    strengthBar.style.width = `${width}%`;

                    let text = '';
                    let color = '';
                    switch (score) {
                        case 0: case 1: text = 'Very Weak'; color = '#ef4444'; break;
                        case 2: text = 'Weak'; color = '#f97316'; break;
                        case 3: text = 'Moderate'; color = '#ca8a04'; break;
                        case 4: text = 'Strong'; color = '#65a30d'; break;
                        case 5: text = 'Very Strong'; color = '#16a34a'; break;
                    }
                    strengthBar.style.backgroundColor = color;
                    strengthText.textContent = text;
                    strengthText.style.color = color;

                    // Time to crack calculation
                    if (password.length > 0) {
                        const combinations = Math.pow(characterPool, password.length);
                        const hashesPerSecond = 10e9; // 10 billion
                        const secondsToCrack = combinations / hashesPerSecond;
                        
                        const timeUnits = [
                            { unit: 'second', limit: 60 },
                            { unit: 'minute', limit: 60 },
                            { unit: 'hour', limit: 24 },
                            { unit: 'day', limit: 365 },
                            { unit: 'year', limit: 1000 },
                            { unit: 'thousand years', limit: 1000 },
                            { unit: 'million years', limit: 1000 },
                            { unit: 'billion years', limit: Infinity }
                        ];

                        let time = secondsToCrack;
                        let unit = 'seconds';
                        if (secondsToCrack < 1) {
                            timeToCrackText.innerHTML = `Cracked <span style="color: ${color};">instantly</span>`;
                        } else {
                            for (const timeUnit of timeUnits) {
                                if (time < timeUnit.limit) {
                                    unit = timeUnit.unit;
                                    break;
                                }
                                time /= timeUnit.limit;
                            }
                            timeToCrackText.innerHTML = `Time to crack: <span style="color: ${color};">${Math.round(time)} ${unit}${Math.round(time) > 1 ? 's' : ''}</span>`;
                        }
                    } else {
                        timeToCrackText.textContent = '';
                    }
                });

                // --- Generator Logic ---
                const newLengthSlider = lengthSlider.cloneNode(true);
                lengthSlider.parentNode.replaceChild(newLengthSlider, lengthSlider);
                newLengthSlider.addEventListener('input', () => { lengthVal.textContent = newLengthSlider.value; });

                const newGenerateBtn = generateBtn.cloneNode(true);
                generateBtn.parentNode.replaceChild(newGenerateBtn, generateBtn);

                newGenerateBtn.addEventListener('click', () => {
                    const length = parseInt(newLengthSlider.value);
                    const includeUppercase = uppercaseCheck.checked;
                    const includeLowercase = lowercaseCheck.checked;
                    const includeNumbers = numbersCheck.checked;
                    const includeSymbols = symbolsCheck.checked;

                    const newPassword = generatePassword(length, includeUppercase, includeLowercase, includeNumbers, includeSymbols);
                    generatedPwOutput.textContent = newPassword;
                    newPasswordInput.value = newPassword;
                    newPasswordInput.dispatchEvent(new Event('input')); // Trigger strength check for generated password
                    newGenerateBtn.classList.add('button-success');
                    setTimeout(() => newGenerateBtn.classList.remove('button-success'), 800);
                });

                // Initial generation on load
                const initialPassword = generatePassword(parseInt(newLengthSlider.value), true, true, true, true);
                generatedPwOutput.textContent = initialPassword;
                newPasswordInput.value = initialPassword;
                newPasswordInput.dispatchEvent(new Event('input'));
            }

            function generatePassword(length, upper, lower, nums, syms) {
                const upperChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                const lowerChars = 'abcdefghijklmnopqrstuvwxyz';
                const numChars = '0123456789';
                const symChars = '!@#$%^&*()_+~`|}{[]:;?><,./-=';
                let allChars = '';
                let password = '';

                if (upper) allChars += upperChars;
                if (lower) allChars += lowerChars;
                if (nums) allChars += numChars;
                if (syms) allChars += symChars;

                if (allChars.length === 0) return '(Select character types)';

                for (let i = 0; i < length; i++) {
                    const randomIndex = Math.floor(Math.random() * allChars.length);
                    password += allChars[randomIndex];
                }
                return password;
            }

            // Malicious App Permissions Demo
            function setupAppPermissionsDemo() {
                const panel = document.getElementById('panel-common-threats-nav-app-permissions');
                if (!panel) return;

                const screen = panel.querySelector('#app-permission-screen');
                if (!screen) return;

                const permissions = [
                    { name: 'Storage', icon: 'folder', reason: 'To save and open your photos.', necessary: true },
                    { name: 'Camera', icon: 'photo_camera', reason: 'To take new photos to edit.', necessary: true },
                    { name: 'Contacts', icon: 'contacts', reason: 'To share photos with your friends.', necessary: false, risk: 'A photo editor does not need your contact list. This could be used to send spam or phishing messages to your friends.' },
                    { name: 'Microphone', icon: 'mic', reason: 'To add voice notes to photos.', necessary: false, risk: 'Unnecessary for basic editing. This could be used to listen to your conversations.' },
                    { name: 'Location', icon: 'location_on', reason: 'To geotag your photos.', necessary: false, risk: 'Can be useful, but tracks your every move. Malicious apps can sell this data or use it to know when you are not home.' }
                ];

                let currentPermissionIndex = 0;

                function showResult() {
                    screen.innerHTML = `
                        <div class="p-4 text-white">
                            <h4 class="text-2xl font-bold text-sky-400">Demo Complete</h4>
                            <p class="mt-4">You've seen how apps can request more data than they need. Always question why an app needs a certain permission.</p>
                            <p class="font-bold mt-4 text-red-400">The less you share, the safer you are.</p>
                            <button id="restart-permissions-demo" class="mt-8 bg-sky-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-sky-600">Try Again</button>
                        </div>
                    `;
                    screen.querySelector('#restart-permissions-demo').addEventListener('click', startDemo);
                }

                function showFeedback(permission, allowed) {
                    let feedbackHtml = '';
                    if (allowed) {
                        if (permission.necessary) {
                            feedbackHtml = `
                                <div class="p-4 text-white text-center">
                                    <span class="material-symbols-outlined text-green-400 text-5xl icon-pop">check_circle</span>
                                    <h4 class="text-xl font-bold mt-2">Correct!</h4>
                                    <p class="mt-2">A photo editor needs access to ${permission.name.toLowerCase()} to function correctly.</p>
                                </div>`;
                        } else {
                            feedbackHtml = `
                                <div class="p-4 text-white text-center">
                                    <span class="material-symbols-outlined text-red-400 text-5xl icon-pop">dangerous</span>
                                    <h4 class="text-xl font-bold mt-2">Risky Choice!</h4>
                                    <p class="mt-2">${permission.risk}</p>
                                    <p class="mt-2 text-yellow-400">You've granted a potentially dangerous permission.</p>
                                </div>`;
                        }
                    } else { // Denied
                        if (permission.necessary) {
                            feedbackHtml = `
                                <div class="p-4 text-white text-center">
                                    <span class="material-symbols-outlined text-yellow-400 text-5xl icon-pop">help</span>
                                    <h4 class="text-xl font-bold mt-2">Heads Up!</h4>
                                    <p class="mt-2">You denied a necessary permission. While safe, the app might not work as expected. In a real scenario, you would weigh the need for the app against the permission.</p>
                                </div>`;
                        } else {
                            feedbackHtml = `
                                <div class="p-4 text-white text-center">
                                    <span class="material-symbols-outlined text-green-400 text-5xl icon-pop">check_circle</span>
                                    <h4 class="text-xl font-bold mt-2">Excellent Choice!</h4>
                                    <p class="mt-2">You correctly identified that a photo editor doesn't need access to your ${permission.name.toLowerCase()}. This is key to protecting your privacy.</p>
                                </div>`;
                        }
                    }
                    screen.innerHTML = feedbackHtml;
                    setTimeout(nextPermission, 4000);
                }

                function nextPermission() {
                    currentPermissionIndex++;
                    if (currentPermissionIndex < permissions.length) {
                        renderPermission(permissions[currentPermissionIndex]);
                    } else {
                        showResult();
                    }
                }

                function renderPermission(permission) {
                    screen.innerHTML = `
                        <div class="bg-slate-200 rounded-2xl p-4 shadow-lg w-full max-w-xs text-slate-800">
                            <div class="text-center">
                                <span class="material-symbols-outlined text-5xl text-sky-600">${permission.icon}</span>
                                <p class="mt-2 font-semibold">Allow "Simple Photo Editor" to access your ${permission.name.toLowerCase()}?</p>
                                <p class="text-xs text-slate-500 mt-2">${permission.reason}</p>
                            </div>
                            <div class="mt-6 flex flex-col space-y-2 font-medium text-sky-700">
                                <button class="permission-deny w-full text-center py-2 hover:bg-slate-300 rounded-lg">Don't allow</button>
                                <button class="permission-allow w-full text-center py-2 hover:bg-slate-300 rounded-lg">Allow</button>
                            </div>
                        </div>
                    `;

                    screen.querySelector('.permission-allow').addEventListener('click', () => showFeedback(permission, true));
                    screen.querySelector('.permission-deny').addEventListener('click', () => showFeedback(permission, false));
                }
                
                function startDemo() {
                    currentPermissionIndex = -1;
                    screen.innerHTML = `
                        <div class="text-center text-white">
                            <img src="https://placehold.co/80x80/7dd3fc/0c4a6e?text=P" alt="App Icon" class="mx-auto rounded-2xl shadow-lg">
                            <h4 class="text-xl font-bold mt-4">Simple Photo Editor</h4>
                            <p class="mt-2">Preparing to install...</p>
                            <div class="w-full bg-gray-600 rounded-full h-2.5 mt-4">
                                <div class="bg-sky-500 h-2.5 rounded-full progress-bar-fill"></div>
                            </div>
                        </div>
                    `;
                    setTimeout(nextPermission, 2500);
                }

                startDemo();
            }

            // Malware/Ransomware Demo
            function setupMalwareDemo() {
                const panel = document.getElementById('panel-common-threats-nav-malware');
                if (!panel) return;

                const malwareButton = panel.querySelector('#malware-download-button');
                const initialScreen = panel.querySelector('#malware-initial-screen');
                const ransomwareScreen = panel.querySelector('#ransomware-screen');
                const ransomwareTimer = panel.querySelector('#ransomware-timer');
                const resetButton = panel.querySelector('#ransomware-reset-button');

                if (!malwareButton || !initialScreen || !ransomwareScreen || !resetButton) return;

                let timerInterval = null;

                function resetDemo() {
                    if (timerInterval) clearInterval(timerInterval);
                    initialScreen.style.visibility = 'visible';
                    initialScreen.style.opacity = '1';
                    ransomwareScreen.classList.remove('active');
                }

                // Use clones to avoid duplicate listeners
                const newMalwareButton = malwareButton.cloneNode(true);
                malwareButton.parentNode.replaceChild(newMalwareButton, malwareButton);
                newMalwareButton.addEventListener('click', () => {
                    initialScreen.style.visibility = 'hidden';
                    initialScreen.style.opacity = '0';
                    ransomwareScreen.classList.add('active');

                    // Start countdown timer
                    let timeLeft = 24 * 60 * 60 - 1;
                    timerInterval = setInterval(() => {
                        if (!ransomwareScreen.classList.contains('active')) {
                            clearInterval(timerInterval);
                            return;
                        }
                        const hours = Math.floor(timeLeft / 3600).toString().padStart(2, '0');
                        const minutes = Math.floor((timeLeft % 3600) / 60).toString().padStart(2, '0');
                        const seconds = (timeLeft % 60).toString().padStart(2, '0');
                        ransomwareTimer.textContent = `${hours}:${minutes}:${seconds}`;
                        timeLeft--;
                        if (timeLeft < 0) {
                            clearInterval(timerInterval);
                            ransomwareTimer.textContent = "TIME'S UP!";
                        }
                    }, 1000);
                });

                const newResetButton = resetButton.cloneNode(true);
                resetButton.parentNode.replaceChild(newResetButton, resetButton);
                newResetButton.addEventListener('click', resetDemo);

                // Initial state
                resetDemo();
            }

            // Vishing Demo
            function setupVishingDemo() {
                 const panel = document.getElementById('panel-common-threats-nav-vishing');
                 if (!panel) return;
                const startBtn = panel.querySelector('#vishing-start-btn');
                const transcriptContainer = panel.querySelector('#vishing-transcript');
                const timerEl = panel.querySelector('#vishing-timer');
                 if (!startBtn || !transcriptContainer || !timerEl) return;


                // Clear previous listeners
                const newStartBtn = startBtn.cloneNode(true);
                startBtn.parentNode.replaceChild(newStartBtn, startBtn);
                let callTimerInterval = null; // To manage timer interval

                 const callScript = [
                     { speaker: 'Scammer', line: "Hello, this is the Fraud Department. We've detected a ₹25,000 transfer. <span class='red-flag'>FEAR/URGENCY</span>" },
                     { speaker: 'You', line: "Wait, I didn't authorize that! How do I stop it?" },
                     { speaker: 'Scammer', line: "Verify the OTP we just sent to cancel. Read it back now! <span class='red-flag'>ASKS FOR 2FA CODE</span>" },
                     { speaker: 'System', line: "<strong>STOP!</strong> Banks NEVER ask for OTPs over phone. Hang up!" }
                 ];


                newStartBtn.addEventListener('click', () => {
                    if (callTimerInterval) clearInterval(callTimerInterval); // Clear previous timer

                    newStartBtn.disabled = true;
                    newStartBtn.classList.add('opacity-50', 'cursor-not-allowed');
                    transcriptContainer.innerHTML = '';
                    let delay = 500;
                    let elapsedSeconds = 0;
                    timerEl.textContent = '00:00';

                     // Start timer
                    callTimerInterval = setInterval(() => {
                        elapsedSeconds++;
                        const minutes = Math.floor(elapsedSeconds / 60).toString().padStart(2, '0');
                        const seconds = (elapsedSeconds % 60).toString().padStart(2, '0');
                        timerEl.textContent = `${minutes}:${seconds}`;
                    }, 1000);

                    callScript.forEach((item, index) => {
                        setTimeout(() => {
                            if (!newStartBtn.disabled) return; // Stop if reset prematurely

                            const p = document.createElement('p');
                            p.classList.add('phone-line');
                            let speakerClass = item.speaker === 'Scammer' ? 'text-red-400' : (item.speaker === 'System' ? 'text-yellow-400 font-bold' : (item.speaker === 'You' ? 'text-white' : 'text-sky-300'));
                            p.innerHTML = `<strong class="${speakerClass}">${item.speaker}:</strong> ${item.line}`;
                            transcriptContainer.appendChild(p);
                            transcriptContainer.scrollTop = transcriptContainer.scrollHeight;
                            
                            requestAnimationFrame(() => p.classList.add('visible')); // Use rAF

                            if (index === callScript.length - 1) {
                                clearInterval(callTimerInterval); // Stop timer
                                newStartBtn.disabled = false;
                                newStartBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                                newStartBtn.textContent = 'Replay Call';
                            }
                        }, delay);
                        delay += item.line.length * 40 + 800; // Adjusted timing
                    });
                });
            }


            // Qishing Demo
            function setupQishingDemo() {
                const panel = document.getElementById('panel-common-threats-nav-qishing');
                if (!panel) return;
                const scanBtn = panel.querySelector('#qishing-scan-btn');
                const alertBox = panel.querySelector('#qishing-alert');
                 if (!scanBtn || !alertBox) return;

                 const newScanBtn = scanBtn.cloneNode(true);
                 scanBtn.parentNode.replaceChild(newScanBtn, scanBtn);
                 let currentTimeoutId = null;

                 newScanBtn.addEventListener('click', () => {
                     if (currentTimeoutId) clearTimeout(currentTimeoutId);
                     alertBox.classList.remove('hidden');
                     newScanBtn.textContent = 'Scanning...';
                     newScanBtn.disabled = true;
                     newScanBtn.classList.add('button-fail');

                     currentTimeoutId = setTimeout(() => {
                        alertBox.classList.add('hidden');
                        newScanBtn.textContent = 'Simulate Scan';
                        newScanBtn.disabled = false;
                        newScanBtn.classList.remove('button-fail');
                        currentTimeoutId = null;
                     }, 4000);
                 });
            }

            // Live Phishing Demo (Moved into Playground)
            function setupLivePhishingDemo() {
                const panel = document.getElementById('panel-common-threats-nav-live-phishing');
                if (!panel) return;

                const phishingForm = panel.querySelector('#phishing-form');
                const formContainer = panel.querySelector('#phishing-form-container');
                const resultContainer = panel.querySelector('#phishing-result');
                const resetDemoButton = panel.querySelector('#reset-demo');
                const typingText = panel.querySelector('#typing-text');
                const typingCursor = panel.querySelector('#typing-cursor');

                if (!phishingForm || !formContainer || !resultContainer || !resetDemoButton || !typingText || !typingCursor) {
                    return; // Elements not found
                }

                // Typing animation logic
                function startTypingAnimation(email, password) {
                    const lines = [
                        `[+] Target captured: ${email}`,
                        `[+] Pwd attempt: ${password.substring(0,2)}********`,
                        `POST /login.php HTTP/1.1`,
                        `-- DATA CAPTURED --`,
                        `email=${encodeURIComponent(email)}`,
                        `pass=${encodeURIComponent(password)}`,
                        `[SUCCESS] Credentials exfiltrated.`
                    ];
                    let lineIndex = 0;
                    let charIndex = 0;
                    typingText.innerHTML = '<span class="text-green-400 mr-2 flex-shrink-0">&gt;</span>';
                    typingCursor.style.visibility = 'visible';

                    function type() {
                        if (lineIndex < lines.length) {
                            if (charIndex < lines[lineIndex].length) {
                                typingText.innerHTML += lines[lineIndex].charAt(charIndex);
                                charIndex++;
                                setTimeout(type, 20);
                            } else {
                                typingText.innerHTML += '<br><span class="text-green-400 mr-2 flex-shrink-0">&gt;</span>';
                                lineIndex++;
                                charIndex = 0;
                                setTimeout(type, 200);
                            }
                        } else {
                            typingCursor.style.visibility = 'hidden';
                            const phishingEmailInput = newPhishingForm.querySelector('#phishing-email');
                            const phishingPasswordInput = newPhishingForm.querySelector('#phishing-password');
                            phishingEmailInput.classList.add('input-error');
                            phishingPasswordInput.classList.add('input-error');
                        }
                    }
                    type();
                }

                // Use clones to avoid duplicate listeners on re-initialization
                const newPhishingForm = phishingForm.cloneNode(true);
                phishingForm.parentNode.replaceChild(newPhishingForm, phishingForm);
                newPhishingForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const email = newPhishingForm.querySelector('#phishing-email').value;
                    const password = newPhishingForm.querySelector('#phishing-password').value;
                    formContainer.classList.add('hidden');
                    resultContainer.classList.remove('hidden');
                    startTypingAnimation(email, password);
                });

                const newResetDemoButton = resetDemoButton.cloneNode(true);
                resetDemoButton.parentNode.replaceChild(newResetDemoButton, resetDemoButton);
                newResetDemoButton.addEventListener('click', function() {
                    resultContainer.classList.add('hidden');
                    formContainer.classList.remove('hidden');
                    newPhishingForm.reset();
                    const phishingEmailInput = newPhishingForm.querySelector('#phishing-email');
                    const phishingPasswordInput = newPhishingForm.querySelector('#phishing-password');
                    phishingEmailInput.classList.remove('input-error');
                    phishingPasswordInput.classList.remove('input-error');
                });

                // Initial state reset
                resultContainer.classList.add('hidden');
                formContainer.classList.remove('hidden');
                newPhishingForm.reset();
            }

            // Credential Stuffing Demo
            function setupCredentialStuffingDemo() {
                const panel = document.getElementById('panel-common-threats-nav-credential-stuffing');
                if (!panel) return;

                const startBtn = panel.querySelector('#start-stuffing-attack');
                const leakedList = panel.querySelector('#leaked-data-list');
                const attackLog = panel.querySelector('#attack-log');

                if (!startBtn || !leakedList || !attackLog) return;

                const leakedData = [
                    { email: 'user1@example.com', pass: 'password123' },
                    { email: 'gamer_x@email.net', pass: 'shadow99' },
                    { email: 'jane.d@workplace.com', pass: 'Fluffy!cat' },
                    { email: 'test.user@email.com', pass: 'password123' },
                    { email: 'mike22@web.org', pass: 'liverpool' }
                ];

                // The password that is reused on the bank site
                const reusedPassword = 'password123';

                function initialize() {
                    leakedList.innerHTML = '';
                    leakedData.forEach(item => {
                        leakedList.innerHTML += `<div><span class="text-gray-500">${item.email}:</span><span class="text-red-600">${item.pass}</span></div>`;
                    });
                    attackLog.innerHTML = '<p class="text-gray-400">Click "Start Attack" to begin...</p>';
                    startBtn.disabled = false;
                    startBtn.textContent = 'Start Attack';
                }

                const newStartBtn = startBtn.cloneNode(true);
                startBtn.parentNode.replaceChild(newStartBtn, startBtn);

                newStartBtn.addEventListener('click', () => {
                    newStartBtn.disabled = true;
                    newStartBtn.textContent = 'Attack in Progress...';
                    attackLog.innerHTML = '';
                    let delay = 0;

                    leakedData.forEach((credential, index) => {
                        setTimeout(() => {
                            let logLine = document.createElement('p');
                            logLine.innerHTML = `> Trying ${credential.email} with pass: ${'*'.repeat(credential.pass.length)}... `;
                            
                            if (credential.pass === reusedPassword) {
                                logLine.innerHTML += `<span class="bg-green-500 text-white font-bold px-2 py-1 rounded">SUCCESS!</span>`;
                                attackLog.appendChild(logLine);
                                
                                let successLine = document.createElement('p');
                                successLine.className = 'text-yellow-400 font-bold mt-2';
                                successLine.textContent = `--> Account for ${credential.email} compromised! Password reuse detected.`;
                                attackLog.appendChild(successLine);

                                // Don't stop the attack, let it finish
                            } else {
                                logLine.innerHTML += `<span class="text-red-500">FAILED</span>`;
                                attackLog.appendChild(logLine);
                            }
                            attackLog.scrollTop = attackLog.scrollHeight;

                            if (index === leakedData.length - 1) {
                                setTimeout(() => {
                                    newStartBtn.disabled = false;
                                    newStartBtn.textContent = 'Restart Attack';
                                }, 500);
                            }

                        }, delay);
                        delay += 1000; // 1 second between attempts
                    });
                });

                initialize();
            }


            // UPI Scam Demo
            function setupUpiDemo() {
                const panel = document.getElementById('panel-india-scams-nav-upi');
                if (!panel) return;
                const upiApprove = panel.querySelector('#upi-approve');
                const upiDecline = panel.querySelector('#upi-decline');
                const upiAlert = panel.querySelector('#upi-alert');
                 if (!upiApprove || !upiDecline || !upiAlert) return;

                const newUpiApprove = upiApprove.cloneNode(true);
                upiApprove.parentNode.replaceChild(newUpiApprove, upiApprove);
                const newUpiDecline = upiDecline.cloneNode(true);
                upiDecline.parentNode.replaceChild(newUpiDecline, upiDecline);
                
                newUpiApprove.addEventListener('click', () => { 
                    upiAlert.classList.remove('hidden'); 
                    newUpiApprove.classList.add('button-fail');
                    setTimeout(() => newUpiApprove.classList.remove('button-fail'), 500);
                });
                newUpiDecline.addEventListener('click', () => { 
                    upiAlert.classList.add('hidden'); 
                    newUpiDecline.classList.add('button-success');
                    setTimeout(() => newUpiDecline.classList.remove('button-success'), 800);
                });
            }

            // Smishing Demo
            function setupSmishingDemo() {
                 const panel = document.getElementById('panel-india-scams-nav-smishing');
                 if (!panel) return;
                const smishingLink = panel.querySelector('#smishing-link');
                const smishingAlert = panel.querySelector('#smishing-alert');
                 if (!smishingLink || !smishingAlert) return;

                const newSmishingLink = smishingLink.cloneNode(true);
                smishingLink.parentNode.replaceChild(newSmishingLink, smishingLink);
                 let currentTimeoutId = null;

                newSmishingLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (currentTimeoutId) clearTimeout(currentTimeoutId);
                    smishingAlert.classList.remove('hidden');
                    newSmishingLink.classList.add('input-error');
                    // Optional: Hide alert after a few seconds
                     currentTimeoutId = setTimeout(() => {
                         smishingAlert.classList.add('hidden');
                         newSmishingLink.classList.remove('input-error');
                         currentTimeoutId = null;
                     }, 4000);
                });
            }

            // --- Main Application Initialization ---
            
            initializeThreatPlayground('common-threats-nav', 'common-threats-content-wrapper', commonThreatsData);
            initializeThreatPlayground('india-scams-nav', 'india-scams-content-wrapper', indiaScamsData);

            // --- Quiz Logic ---
            const quizContainer = document.getElementById('quiz-container');
            const quizResultContainer = document.getElementById('quiz-result');
            const quizScoreEl = document.getElementById('quiz-score');
            const quizTotalEl = document.getElementById('quiz-total');
            const quizFeedbackEl = document.getElementById('quiz-feedback');
            const quizRetryButton = document.getElementById('quiz-retry-button');
             const quizData = [
                 { question: "Our scammer friend Deepak sends an email from 'Neflix' (nice spelling!) saying your subscription expired. The link goes to 'neflix-payments.com'. What should you do?", options: ["Ignore it, open a browser, go to the official Netflix site, and check your account there.", "Panic and click the link immediately. The show must go on!", "Reply with your credit card details and a list of your favorite shows.", "Forward it to friends to see if they can pay for it."], answer: 0 },
                 { question: "Rekha, a notorious password guesser, is trying to hack your bank account. Which password would make her cry?", options: ["password123", "12345678", "MyB@nkL0vesM3!", "RekhaFan#1"], answer: 2 },
                 { question: "The infamous scammer Akshay calls, claiming to be 'Microsoft Support'. He says your PC has more viruses than a hospital and asks for remote access. What's your move?", options: ["Grant access immediately. He sounds so helpful!", "Politely hang up. Microsoft doesn't cold-call you about viruses; they have better things to do.", "Ask for his employee ID so you can report him for being too good at his scam.", "Give him your bank details to pay for the 'fix'."], answer: 1 },
                 { question: "Roshitha, a professional Wi-Fi snooper, is lurking at a coffee shop. What's the safest way to check your bank balance?", options: ["Use the public Wi-Fi. It's called 'Free' for a reason, right?", "Ask Roshitha to check for you. She looks trustworthy.", "Disconnect from Wi-Fi and use your own mobile data.", "Shout your login details to the barista."], answer: 2 },
                 { question: "Saran, the malware maestro, offers you 'Movie.exe' from a sketchy site. What's the MOST LIKELY outcome?", options: ["Saran's ransomware encrypts your files and demands payment in pizza.", "You enjoy the movie in stunning 4K, and Saran becomes your best friend.", "The file magically cleans your PC and does your laundry.", "It installs a virus that makes your computer only speak in rhymes."], answer: 0 },
                 { question: "Purva, a wannabe hacker, is trying to get into your Instagram. You get a login code via SMS you didn't request. What does this mean?", options: ["Your phone is haunted and is texting you secrets.", "It's a promotional code for 50% off your next data breach.", "Purva has your password and is trying to log in, but your 2FA is gloriously stopping her.", "A friend is playing a very, very unfunny prank."], answer: 2 },
                 { question: "The trickster Arbaz sends you a UPI 'Collect Request' for ₹5,000, calling it a 'refund'. What happens if you enter your PIN?", options: ["A shower of digital confetti fills your screen.", "You generously donate ₹5,000 to The Arbaz Foundation for Scammers.", "You magically receive ₹5,000.", "The app plays a sad trombone sound."], answer: 1 },
                 { question: "Sanjay, a social media stalker, sees a photo of your puppy 'SlimShady' and knows your password is 'slimshady123'. Why is this a disaster?", options: ["The puppy might get a big ego from all the attention.", "It's easy to remember, so it's a great password!", "Sanjay is using your public info to easily guess your password. Classic rookie mistake.", "Your friends might steal the password to post embarrassing photos of you."], answer: 2 },
                 { question: "Leema, an aspiring corporate spy, 'accidentally' drops a USB labeled 'Executive Salaries' in the parking lot. What should you do?", options: ["Give it to IT/Security without plugging it in. Don't fall for Leema's trap!", "Plug it in immediately! You deserve to know what everyone makes.", "Keep it. Finders keepers, corporate secrets keepers.", "Ask a colleague you don't like to plug it in first."], answer: 0 },
                 { question: "The con artist Aasim sends you an SMS: 'Your electricity will be disconnected tonight due to a pending bill' with a suspicious link. What's his main tactic?", options: ["Creating a sense of panic and urgency to make you click without thinking.", "He's genuinely concerned about your access to electricity.", "He's testing your reading comprehension.", "He wants to see if you'll reply with a witty comeback."], answer: 0 },
                 { question: "Sudarshan, the QR code kingpin, is 'buying' your old phone. He sends a QR code and asks you to scan & enter your PIN to 'receive' money. What's the play?", options: ["Scan it but enter the PIN for your pizza delivery app instead.", "Ask Sudarshan to send the code to your rival instead.", "Refuse. Scanning a QR code and entering a PIN is for PAYING, not receiving. Nice try, Sudarshan.", "Follow his instructions. Maybe it's a new, super-secret payment method!"], answer: 2 },
                 { question: "Nivas, the data harvester, sends you a friend request and asks for your mother's maiden name 'for a fun survey'. This is likely:", options: ["A very, very curious new friend who loves family history.", "Your soulmate in disguise.", "A classic social engineering attempt to gather security question answers. Block Nivas!", "A harmless survey that will definitely not be used against you."], answer: 2 },
                 { question: "Loha, the email prankster, sends you an old email attachment 'PARTY_PICS_2020.zip' from an unknown sender. What's the safest action?", options: ["Forward it to all your friends to see if they recognize anyone.", "Delete the email permanently without opening the attachment. No party is worth a virus.", "Open it. You might have been at that party and just forgot.", "Reply and ask Loha for a hint about who is in the pictures."], answer: 1 },
                 { question: "Akash, a master of disguise, creates a fake login page for your bank that looks 100% real. How can you spot the fake?", options: ["Check the URL in the address bar. If it's not the official bank URL, it's a trap!", "If the colors look slightly off, it's probably a fake.", "Enter your password. If it works, it's real. If not, it's fake.", "Trust your gut. If it feels wrong, it's probably fine."], answer: 0 },
                 { question: "The notorious scammer Keshu offers you a 'free' iPhone if you just pay a tiny ₹500 shipping fee. What's the catch?", options: ["The 'shipping fee' is the scam. There is no iPhone, only sadness.", "The iPhone is real, but it's a much older model.", "You have to write a 500-word essay on why you deserve the iPhone.", "Keshu will personally deliver the phone but will eat all your snacks."], answer: 0 }
            ];

            let currentQuestionIndex = 0;
            let score = 0;
            let questionsAnswered = 0;

            // Function to shuffle array
            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            function loadQuiz() {
                currentQuestionIndex = 0;
                score = 0;
                questionsAnswered = 0;
                shuffle(quizData); // Shuffle questions each time
                quizResultContainer.classList.add('hidden');
                quizContainer.classList.remove('hidden');
                showQuestion();
            }

            function showQuestion() {
                if (currentQuestionIndex >= quizData.length) {
                    // This condition might not be met if we limit questions
                    showResults();
                    return;
                }

                const questionData = quizData[currentQuestionIndex];
                quizContainer.innerHTML = `
                    <div class="bg-slate-50 p-6 rounded-lg shadow-inner">
                        <p class="text-lg font-semibold text-slate-800">${currentQuestionIndex + 1}. ${questionData.question}</p>
                        <div class="mt-4 space-y-3" id="quiz-options-container">
                            ${questionData.options.map((option, index) => `
                                <div class="quiz-option p-4 rounded-lg cursor-pointer" data-index="${index}">
                                    ${option}
                                </div>
                            `).join('')}

                        </div>
                    </div>
                `;

                const options = quizContainer.querySelectorAll('.quiz-option');
                options.forEach(option => {
                    option.addEventListener('click', (e) => {
                        const selectedIndex = parseInt(e.currentTarget.dataset.index);
                        const correctIndex = questionData.answer;

                        // Disable all options after one is clicked
                        options.forEach(opt => opt.style.pointerEvents = 'none');

                        if (selectedIndex === correctIndex) {
                            score++;
                            e.currentTarget.classList.add('correct', 'button-success');
                            confetti({
                                particleCount: 100,
                                spread: 70,
                                origin: { y:  0.6 }
                            });
                        } else {
                            e.currentTarget.classList.add('incorrect', 'button-fail');
                            // Highlight the correct answer
                            options[correctIndex].classList.add('correct');
                        }
                        
                        questionsAnswered++;

                        setTimeout(() => {
                            if (questionsAnswered >= quizData.length) { // Check against total questions
                                showResults();
                            } else {
                                currentQuestionIndex++;
                                showQuestion();
                            }
                        }, 1500); // Wait 1.5 seconds before next question
                    });
                });
            }

            function showResults() {
                quizContainer.classList.add('hidden');
                quizResultContainer.classList.remove('hidden');
                quizScoreEl.textContent = score;
                quizTotalEl.textContent = quizData.length;

                let feedback = '';
                const percentage = (score / quizData.length) * 100;
                if (percentage >= 80) {
                    feedback = "Excellent work! You have a strong understanding of these concepts.";
                    confetti({
                        particleCount: 200,
                        spread: 120,
                        origin: { y: 0.6 }
                    });
                } else if (percentage >= 50) {
                    feedback = "Good job! A quick review of the material will solidify your knowledge.";
                } else {
                    feedback = "It's a great start. We recommend reviewing the threat sections again to boost your awareness.";
                }
                quizFeedbackEl.textContent = feedback;
            }
            quizRetryButton.addEventListener('click', loadQuiz);
            loadQuiz(); // Initial call

             // --- Wi-Fi Drag and Drop Game ---
             const wifiItems = document.querySelectorAll('.wifi-item');
             const dropzones = document.querySelectorAll('.wifi-dropzone');
             const wifiFeedback = document.getElementById('wifi-feedback');
             let correctDrops = 0;
             const totalItems = wifiItems.length;
             const initialItemsParent = document.getElementById('wifi-items');
             const initialItemsHTML = initialItemsParent.innerHTML; // Store initial state

             function resetWifiGame() {
                correctDrops = 0;
                wifiFeedback.textContent = '';
                dropzones.forEach(zone => {
                    // Remove items added during the game
                    zone.querySelectorAll('.wifi-item').forEach(item => item.remove());
                });
                initialItemsParent.innerHTML = initialItemsHTML; // Restore initial items
                attachWifiDragListeners(); // Re-attach listeners to the new elements
             }


             function attachWifiDragListeners() {
                const currentWifiItems = document.querySelectorAll('.wifi-item');
                currentWifiItems.forEach(item => {
                    item.addEventListener('dragstart', (e) => {
                     e.dataTransfer.setData('text/plain', item.id || item.textContent); // Fallback ID
                     item.classList.add('dragging');
                 });
                 item.addEventListener('dragend', () => {
                     item.classList.remove('dragging');
                 });
                });
             }


             dropzones.forEach(zone => {
                 zone.addEventListener('dragover', e => {
                     e.preventDefault(); // Necessary to allow drop
                     zone.classList.add('dragover');
                 });
                 zone.addEventListener('dragleave', () => {
                     zone.classList.remove('dragover');
                 });
                 zone.addEventListener('drop', e => {
                     e.preventDefault();
                     zone.classList.remove('dragover');
                     const draggedItem = document.querySelector('.dragging'); // Find the item being dragged
                     if (!draggedItem) return;

                     const isSafeActivity = draggedItem.dataset.safe === 'true';
                     const isCorrectZone = (zone.id === 'wifi-safe' && isSafeActivity) || (zone.id === 'wifi-unsafe' && !isSafeActivity);
                     
                     let feedbackText = '';
                     let feedbackColor = '';

                     if (isCorrectZone) {
                         zone.appendChild(draggedItem); // Move the item
                         draggedItem.classList.remove('bg-sky-100');
                         draggedItem.classList.add(isSafeActivity ? 'bg-green-200' : 'bg-red-200', 'cursor-not-allowed');
                         draggedItem.setAttribute('draggable', 'false'); // Disable further dragging
                         
                         zone.classList.add('correct-drop');
                         setTimeout(() => zone.classList.remove('correct-drop'), 800);

                         correctDrops++;

                         if (correctDrops === totalItems) {
                            wifiFeedback.textContent = 'All sorted correctly! You know your Wi-Fi safety!';
                            wifiFeedback.className = 'text-center mt-4 font-bold h-6 text-green-600';
                            setTimeout(resetWifiGame, 4000); // Auto-reset the game
                            return; // Stop further feedback timeouts
                         }

                     } else {
                         zone.classList.add('incorrect-drop');
                         setTimeout(() => zone.classList.remove('incorrect-drop'), 500);
                     }
                     
                     wifiFeedback.textContent = feedbackText;
                     wifiFeedback.className = `text-center mt-4 font-bold h-6 ${feedbackColor}`;
                 });
             });

            attachWifiDragListeners(); // Initial attachment


             // --- Threat Intelligence Feed ---
             const threatFeedContainer = document.getElementById('threat-feed');
              const threats = [
                "[breach] Healthcare provider hit by RANSOMWARE, 2M patient records encrypted.",
                "[phish] Financial services firm targeted in large-scale SPEAR PHISHING campaign.",
                "[leak] Social media giant leaks 500M user profiles due to misconfigured cloud server.",
                "[malware] Critical infrastructure targeted by state-sponsored ZERO-DAY exploit.",
                "[supply-chain] Popular software update hijacked to distribute backdoors to thousands of companies."
              ];
             let threatIndex = 0;
              let feedIntervalId = null; // Store interval ID

              function addThreatToFeed() {
                if (!threatFeedContainer) return; // Ensure element exists
                const p = document.createElement('p');
                p.className = 'p-2 border-b border-slate-700';
                p.innerHTML = `<span class="text-red-500">${new Date().toLocaleTimeString()}</span>: ${threats[threatIndex]}`;
                threatFeedContainer.prepend(p);
                
                // Keep the list from getting too long
                while (threatFeedContainer.children.length > 10) {
                    threatFeedContainer.lastChild.remove();
                }

                threatIndex = (threatIndex + 1) % threats.length;
              }

              // Start the feed interval
              function startThreatFeed() {
                  if (feedIntervalId) clearInterval(feedIntervalId); // Clear existing interval if any
                  addThreatToFeed(); // Add initial item immediately
                  feedIntervalId = setInterval(addThreatToFeed, 3000); // Add new item every 3 seconds
              }

              startThreatFeed(); // Start the feed
        });
    </script>
</body>
</html>
